<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:converters="clr-namespace:KProcess.Presentation.Windows.Converters"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:data="clr-namespace:KProcess.Presentation.Windows.Data"
                    xmlns:local="clr-namespace:KProcess.Presentation.Windows.Controls"
                    xmlns:localization="clr-namespace:KProcess.Presentation.Windows.Localization"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    mc:Ignorable="d">

    <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    <converters:NegatedBooleanToVisibilityConverter x:Key="NegatedBooleanToVisibilityConverter" />

    <LinearGradientBrush x:Key="ControlBackgroundNormal" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Offset="0.164" Color="#FFF7F7F7" />
        <GradientStop Offset="0.802" Color="#FFC6C6C6" />
        <GradientStop Offset="0.953" Color="#FFC6C6C6" />
    </LinearGradientBrush>

    <DrawingBrush x:Key="FilmBrush">
        <DrawingBrush.Drawing>
            <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 888.616,555.303L 888.616,562.22L 878.933,562.22L 878.933,555.303L 870.632,555.303L 870.632,558.07L 806.996,558.07L 806.996,555.303L 798.695,555.303L 798.695,562.22L 789.012,562.22L 789.012,555.303L 782.095,555.303L 782.095,667.358L 789.012,667.358L 789.012,660.441L 798.695,660.441L 798.695,667.358L 806.996,667.358L 806.996,664.591L 870.632,664.591L 870.632,667.358L 878.933,667.358L 878.933,660.441L 888.616,660.441L 888.616,667.358L 896.917,667.358L 896.917,555.303L 888.616,555.303 Z M 798.695,653.524L 789.012,653.524L 789.012,642.457L 798.695,642.457L 798.695,653.524 Z M 798.695,635.54L 789.012,635.54L 789.012,624.473L 798.695,624.473L 798.695,635.54 Z M 798.695,616.172L 789.012,616.172L 789.012,605.105L 798.695,605.105L 798.695,616.172 Z M 798.695,598.188L 789.012,598.188L 789.012,587.121L 798.695,587.121L 798.695,598.188 Z M 798.695,580.204L 789.012,580.204L 789.012,569.137L 798.695,569.137L 798.695,580.204 Z M 870.632,660.441L 806.996,660.441L 806.996,613.406L 870.632,613.406L 870.632,660.441 Z M 870.632,609.255L 806.996,609.255L 806.996,562.22L 870.632,562.22L 870.632,609.255 Z M 888.616,653.524L 878.933,653.524L 878.933,642.457L 888.616,642.457L 888.616,653.524 Z M 888.616,635.54L 878.933,635.54L 878.933,624.473L 888.616,624.473L 888.616,635.54 Z M 888.616,616.172L 878.933,616.172L 878.933,605.105L 888.616,605.105L 888.616,616.172 Z M 888.616,598.188L 878.933,598.188L 878.933,587.121L 888.616,587.121L 888.616,598.188 Z M 888.616,580.204L 878.933,580.204L 878.933,569.137L 888.616,569.137L 888.616,580.204 Z " />
        </DrawingBrush.Drawing>
    </DrawingBrush>

    <DrawingBrush x:Key="ScreenBrush" Stretch="Uniform">
        <DrawingBrush.Drawing>
            <DrawingGroup>
                <DrawingGroup.Children>
                    <GeometryDrawing Geometry="M 2,4L 31,4L 31,23L 19,23L 19,29L 26,29L 7,29L 15,29L 15,28L 15,23L 2,23L 2,4 Z ">
                        <GeometryDrawing.Pen>
                            <Pen Brush="{StaticResource ControlBackgroundNormal}"
                                 EndLineCap="Square"
                                 MiterLimit="2.75"
                                 StartLineCap="Square"
                                 Thickness="2" />
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>
                    <GeometryDrawing Geometry="F1 M 17,22.9788L 17,28.9788">
                        <GeometryDrawing.Pen>
                            <Pen Brush="{StaticResource ControlBackgroundNormal}"
                                 EndLineCap="Square"
                                 MiterLimit="2.75"
                                 StartLineCap="Square"
                                 Thickness="2" />
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>
                </DrawingGroup.Children>
            </DrawingGroup>
        </DrawingBrush.Drawing>
    </DrawingBrush>

    <DrawingBrush x:Key="FullScreenBrush">
        <DrawingBrush.Drawing>
            <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="M 19,57L 19,19L 57,19L 57,57L 19,57 Z M 24,29L 47,29L 47,52L 52,52L 52,24L 24,24L 24,29 Z M 24,34L 24,52L 42,52L 42,34L 24,34 Z" />
        </DrawingBrush.Drawing>
    </DrawingBrush>

    <Style TargetType="{x:Type local:KMediaPlayer}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="MarkerItemContainerStyle">
            <Setter.Value>
                <Style TargetType="{x:Type ListBoxItem}">
                    <Setter Property="IsEnabled" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}, Path=IsReadOnly, Converter={converters:NegatedBooleanConverter}}" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Panel.ZIndex" Value="9999" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Panel.ZIndex" Value="99999" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:KMediaPlayer}">

                    <Border d:DesignHeight="394"
                            d:DesignWidth="729.43"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <DockPanel>
                            <Grid DockPanel.Dock="Bottom">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!--  Pour le mute/unmute, regarder dans l'historique TFS  -->

                                <!--
                                User Story 4371:Modifier la strategie de selection des videos
                                <Button x:Name="PART_Stop" Grid.Column="0" Margin="30,3,5,3" HorizontalAlignment="Center" VerticalAlignment="Center" Cursor="Hand" Focusable="{TemplateBinding Focusable}"
                                        Visibility="{TemplateBinding StopVisibility}"
                                        ToolTip="{localization:Localize KMediaPlayer_Stop}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <Border Height="24" Width="24" Background="{StaticResource FilmBrush}" />
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>-->

                                <Border x:Name="PART_Thumbnail"
                                        Grid.Column="1"
                                        Width="24"
                                        Height="24"
                                        Margin="5,3"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        Cursor="Hand"
                                        Focusable="{TemplateBinding Focusable}"
                                        IsEnabled="{Binding DataContext.IsReadOnly, Converter={converters:NegatedBooleanConverter}, RelativeSource={RelativeSource TemplatedParent}}"
                                        Visibility="{TemplateBinding ThumbnailVisibility}">
                                    <Border.Style>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="ToolTip" Value="{localization:Localize KMediaPlayer_Thumbnail}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding HasThumbnail, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}" Value="true">
                                                    <Setter Property="ToolTip" Value="{localization:Localize KMediaPlayer_Thumbnail_Remove}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Border Width="24" Height="20">
                                        <Border.Style>
                                            <Style TargetType="{x:Type Border}">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <DrawingBrush Stretch="Uniform">
                                                            <DrawingBrush.Drawing>
                                                                <DrawingGroup ClipGeometry="F1 M 0,0L 77.7461,0L 77.7461,77.7473L 0,77.7473L 0,0">
                                                                    <DrawingGroup.Children>
                                                                        <GeometryDrawing Geometry="F1 M 45.6068,31.3191C 52.5521,31.3191 58.1777,36.944 58.1777,43.8828C 58.1777,50.8222 52.5521,56.4472 45.6068,56.4472C 38.6745,56.4472 33.0489,50.8222 33.0489,43.8828C 33.0489,36.944 38.6745,31.3191 45.6068,31.3191 Z M 45.5365,24.1185C 34.8581,24.1185 26.1524,32.8177 26.1524,43.5065C 26.1524,54.192 34.8581,62.89 45.5365,62.89C 56.2285,62.89 64.9206,54.192 64.9206,43.5065C 64.9206,32.8177 56.2285,24.1185 45.5365,24.1185 Z M 62.1745,11C 63.8007,11 65.1205,12.317 65.1205,13.9414L 65.1205,17.4688C 65.1205,17.5417 65.1074,17.612 65.1074,17.6849L 69.6666,17.6849C 72.4531,17.6849 74.7461,19.9713 74.7461,22.763L 74.7461,63.3978C 74.7461,66.1894 72.4531,68.4759 69.6666,68.4759L 8.7149,68.4759C 5.92838,68.4759 3.63544,66.1894 3.63544,63.3978L 3.63544,22.763C 3.63544,19.9713 5.92838,17.6849 8.7149,17.6849L 11.1413,17.6849C 11.1276,17.5937 11.1276,17.5065 11.1276,17.4141L 11.1276,15.8119C 11.1276,13.4492 13.0345,11.5345 15.394,11.5345L 33.0449,11.5345C 35.405,11.5345 37.3242,13.4492 37.3242,15.8119L 37.3242,17.4141C 37.3242,17.5065 37.3112,17.5937 37.2975,17.6849L 59.2546,17.6849C 59.2415,17.612 59.2415,17.5417 59.2415,17.4688L 59.2415,13.9414C 59.2415,13.5065 59.3346,13.093 59.5078,12.7213L 59.5078,12.6029L 59.5612,12.6029C 60.0547,11.6536 61.041,11 62.1745,11 Z">
                                                                            <GeometryDrawing.Brush>
                                                                                <LinearGradientBrush StartPoint="-4.29156e-007,0.5" EndPoint="1,0.5">
                                                                                    <LinearGradientBrush.GradientStops>
                                                                                        <GradientStop Offset="0.164" Color="#FFF7F7F7" />
                                                                                        <GradientStop Offset="0.802" Color="#FFC6C6C6" />
                                                                                        <GradientStop Offset="1" Color="#FFC6C6C6" />
                                                                                    </LinearGradientBrush.GradientStops>
                                                                                </LinearGradientBrush>
                                                                            </GeometryDrawing.Brush>
                                                                        </GeometryDrawing>
                                                                    </DrawingGroup.Children>
                                                                </DrawingGroup>
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding HasThumbnail, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}" Value="true">
                                                        <Setter Property="Background">
                                                            <Setter.Value>
                                                                <DrawingBrush>
                                                                    <DrawingBrush.Drawing>
                                                                        <DrawingGroup ClipGeometry="F1 M 0,0L 77.7461,0L 77.7461,77.7473L 0,77.7473L 0,0">
                                                                            <DrawingGroup.Children>
                                                                                <GeometryDrawing Geometry="F1 M 57.1778,41.6855C 57.1778,37.8912 55.4884,34.498 52.8288,32.1945L 46.1504,38.8729L 55.3933,48.1158C 56.5189,46.233 57.1778,44.039 57.1778,41.6855 Z M 69.4552,15.5676L 57.808,27.2155C 61.5619,30.7539 63.9207,35.7557 63.9207,41.3092C 63.9207,45.621 62.4877,49.5963 60.097,52.8189L 72.1486,64.871C 73.1258,63.9439 73.7461,62.6445 73.7461,61.2005L 73.7461,20.5657C 73.7461,18.0443 71.8705,15.9524 69.4552,15.5676 Z M 44.6068,54.2499C 45.347,54.2499 46.0677,54.1731 46.7728,54.0507L 38.8731,46.151L 35.1219,49.9023C 37.4252,52.5611 40.8164,54.2499 44.6068,54.2499 Z M 25.1524,41.3092C 25.1524,38.6881 25.6818,36.19 26.6296,33.9075L 8.21039,15.4876L 7.71497,15.4876C 4.92841,15.4876 2.63544,17.774 2.63544,20.5657L 2.63544,61.2005C 2.63544,62.9921 3.58533,64.565 4.99817,65.47L 25.5092,44.9589C 25.282,43.7753 25.1524,42.5579 25.1524,41.3092 Z M 44.5365,21.9212C 45.7865,21.9212 47.0059,22.0507 48.1901,22.2779L 54.9805,15.4876L 36.2976,15.4876C 36.3112,15.3964 36.3242,15.3092 36.3242,15.2168L 36.3242,13.6145C 36.3242,11.2519 34.4051,9.33719 32.045,9.33719L 16.6147,9.33719L 33.0268,25.7487C 36.2513,23.356 40.2267,21.9212 44.5365,21.9212 Z M 61.1745,8.80264C 60.041,8.80264 59.0548,9.45627 58.5612,10.4056L 58.5078,10.4056L 58.5078,10.524C 58.3347,10.8958 58.2416,11.3092 58.2416,11.7441L 58.2416,12.2265L 61.6205,8.84763C 61.474,8.82547 61.3274,8.80264 61.1745,8.80264 Z M 44.5365,60.6927C 38.9884,60.6927 33.9864,58.332 30.448,54.5768L 18.7461,66.2786L 59,66.2786L 51.9388,59.2174C 49.6563,60.164 47.1582,60.6927 44.5365,60.6927 Z M 40.7285,29.7395C 39.8295,30.0319 38.9805,30.4283 38.1829,30.9049L 38.8731,31.5949L 40.7285,29.7395 Z ">
                                                                                    <GeometryDrawing.Brush>
                                                                                        <LinearGradientBrush StartPoint="-4.29156e-007,0.5" EndPoint="1,0.5">
                                                                                            <LinearGradientBrush.GradientStops>
                                                                                                <GradientStop Offset="0.164" Color="#FFF7F7F7" />
                                                                                                <GradientStop Offset="0.802" Color="#FFC6C6C6" />
                                                                                                <GradientStop Offset="1" Color="#FFC6C6C6" />
                                                                                            </LinearGradientBrush.GradientStops>
                                                                                        </LinearGradientBrush>
                                                                                    </GeometryDrawing.Brush>
                                                                                </GeometryDrawing>
                                                                                <GeometryDrawing Geometry="F1 M 3.5072,77.7473L 77.7461,3.50574L 74.2403,0L 0,74.2395L 3.5072,77.7473 Z ">
                                                                                    <GeometryDrawing.Brush>
                                                                                        <LinearGradientBrush StartPoint="0.48743,0.474286" EndPoint="0.532542,0.519399">
                                                                                            <LinearGradientBrush.GradientStops>
                                                                                                <GradientStop Offset="0.164" Color="#FFF7F7F7" />
                                                                                                <GradientStop Offset="0.802" Color="#FFC6C6C6" />
                                                                                                <GradientStop Offset="1" Color="#FFC6C6C6" />
                                                                                            </LinearGradientBrush.GradientStops>
                                                                                        </LinearGradientBrush>
                                                                                    </GeometryDrawing.Brush>
                                                                                </GeometryDrawing>
                                                                                <GeometryDrawing Geometry="F1 M 74.239,77.7473L 0,3.50574L 3.50589,0L 77.7461,74.2395L 74.239,77.7473 Z ">
                                                                                    <GeometryDrawing.Brush>
                                                                                        <LinearGradientBrush StartPoint="0.52973,0.474286" EndPoint="0.484616,0.519399">
                                                                                            <LinearGradientBrush.GradientStops>
                                                                                                <GradientStop Offset="0.164" Color="#FFF7F7F7" />
                                                                                                <GradientStop Offset="0.802" Color="#FFC6C6C6" />
                                                                                                <GradientStop Offset="1" Color="#FFC6C6C6" />
                                                                                            </LinearGradientBrush.GradientStops>
                                                                                        </LinearGradientBrush>
                                                                                    </GeometryDrawing.Brush>
                                                                                </GeometryDrawing>
                                                                            </DrawingGroup.Children>
                                                                        </DrawingGroup>
                                                                    </DrawingBrush.Drawing>
                                                                </DrawingBrush>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                    </Border>
                                </Border>

                                <ToggleButton x:Name="MarkersLinked"
                                              Grid.Column="2"
                                              Margin="5,3"
                                              Padding="2"
                                              Cursor="Hand"
                                              Focusable="{TemplateBinding Focusable}"
                                              IsChecked="{Binding AreMarkersLinked, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                              IsEnabled="{Binding DataContext.IsReadOnly, Converter={converters:NegatedBooleanConverter}, RelativeSource={RelativeSource TemplatedParent}}"
                                              Visibility="{TemplateBinding MarkersLinkedVisibility}">
                                    <ToggleButton.Template>
                                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                                            <Grid Width="24" Height="24">
                                                <Rectangle x:Name="Linked" Visibility="Collapsed">
                                                    <Rectangle.Fill>
                                                        <DrawingBrush>
                                                            <DrawingBrush.Drawing>
                                                                <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 33.7187,1.156C 32.8853,0.322662 31.5307,0.322662 30.6973,1.156L 26.3587,5.5C 24.5773,4.32266 22.5253,3.728 20.4733,3.728C 17.744,3.728 15.0147,4.77067 12.932,6.85333L 6.53067,13.2547C 2.88533,16.9053 2.432,22.5413 5.17733,26.676L 0.833333,31.02C 1.78814e-007,31.8533 1.78814e-007,33.208 0.833333,34.0413C 1.24933,34.4573 1.796,34.6667 2.33867,34.6667C 2.89067,34.6667 3.432,34.4573 3.848,34.0413L 8.192,29.6973C 9.97333,30.8747 12.0253,31.4627 14.072,31.4627C 16.8067,31.4627 19.5307,30.4213 21.6147,28.3373L 28.0147,21.9373C 31.6667,18.2907 32.1147,12.656 29.3747,8.51467L 33.7133,4.17067C 34.552,3.33733 34.552,1.98933 33.7187,1.156 Z M 26.8747,14.3947C 26.8747,16.104 26.208,17.7133 25,18.9213L 18.5987,25.3227C 17.3907,26.5307 15.7813,27.1973 14.072,27.1973C 13.1093,27.1973 12.1813,26.9627 11.3333,26.5573L 14.5147,23.3747C 15.348,22.5413 15.348,21.1867 14.5147,20.3533C 13.6813,19.52 12.3333,19.52 11.5,20.3533L 8.31733,23.5413C 7.90533,22.692 7.672,21.7653 7.672,20.796C 7.672,19.088 8.33867,17.4787 9.552,16.2707L 15.948,9.87467C 17.156,8.66667 18.7653,8 20.4733,8C 21.4427,8 22.364,8.23333 23.2187,8.64L 19.968,11.8907C 19.1347,12.724 19.1347,14.072 19.968,14.9053C 20.3853,15.3227 20.9267,15.5307 21.4733,15.5307C 22.0253,15.5307 22.568,15.3227 22.984,14.9053L 26.2347,11.656C 26.64,12.504 26.8747,13.4267 26.8747,14.3947 Z " />
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>

                                                <Rectangle x:Name="NotLinked" Visibility="Collapsed">
                                                    <Rectangle.Fill>
                                                        <DrawingBrush>
                                                            <DrawingBrush.Drawing>
                                                                <DrawingGroup>
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 7.78132,16.3134L 9.72222,14.3889L 13.4444,18.1111L 11.4968,20.0286C 10.0054,21.515 9.18605,23.4944 9.18605,25.5951C 9.18605,26.7881 9.47323,27.9286 9.9803,28.9739L 11.635,27.3127C 12.1471,26.8006 13.737,25.7926 15.378,27.4336C 17.019,29.0746 15.8586,30.5181 15.3454,31.0312L 13.6923,32.686C 14.736,33.1848 15.8781,33.4736 17.063,33.4736C 19.1668,33.4736 21.1475,32.6531 22.6342,31.1664L 24.5563,29.2229L 28.2912,32.9311L 26.3463,34.8767C 23.7813,37.4416 20.4287,38.7233 17.063,38.7233C 14.544,38.7233 12.0185,37.9996 9.82605,36.5506L 4.47959,41.897C 3.96758,42.409 3.30133,42.6667 2.62194,42.6667C 1.95405,42.6667 1.28122,42.409 0.769231,41.897C -0.25641,40.8714 -0.25641,39.2041 0.769231,38.1785L 6.11568,32.832C 2.73682,27.7432 3.29477,20.8066 7.78132,16.3134 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 2.22109,10.7057L 4.94017,10.7057C 5.53494,10.7057 6.01709,11.1879 6.01709,11.7826L 6.01709,11.7826C 6.01709,12.3774 5.53494,12.8596 4.94017,12.8596L 2.22109,12.8596C 1.62632,12.8596 1.14416,12.3774 1.14416,11.7826L 1.14416,11.7826C 1.14416,11.1879 1.62632,10.7057 2.22109,10.7057 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 5.10368,4.07029L 7.45561,6.33902C 7.88368,6.75195 7.89596,7.4337 7.48303,7.86177L 7.48303,7.86177C 7.07011,8.28984 6.38835,8.30211 5.96028,7.88919L 3.60835,5.62045C 3.18028,5.20753 3.16801,4.52577 3.58093,4.0977L 3.58093,4.0977C 3.99386,3.66963 4.67562,3.65736 5.10368,4.07029 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 12.5117,2.1325L 12.5117,4.85158C 12.5117,5.44634 12.0296,5.9285 11.4348,5.9285L 11.4348,5.9285C 10.84,5.9285 10.3579,5.44634 10.3579,4.85158L 10.3579,2.1325C 10.3579,1.53773 10.84,1.05557 11.4348,1.05557L 11.4348,1.05557C 12.0296,1.05557 12.5117,1.53773 12.5117,2.1325 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 40.2126,31.6413L 37.4935,31.6413C 36.8987,31.6413 36.4166,31.1592 36.4166,30.5644L 36.4166,30.5644C 36.4166,29.9696 36.8987,29.4875 37.4935,29.4875L 40.2126,29.4875C 40.8074,29.4875 41.2895,29.9696 41.2895,30.5644L 41.2895,30.5644C 41.2895,31.1592 40.8074,31.6413 40.2126,31.6413 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 37.33,38.2768L 34.9781,36.008C 34.55,35.5951 34.5377,34.9133 34.9506,34.4853L 34.9506,34.4853C 35.3636,34.0572 36.0453,34.0449 36.4734,34.4579L 38.8253,36.7266C 39.2534,37.1395 39.2657,37.8213 38.8527,38.2493L 38.8527,38.2493C 38.4398,38.6774 37.7581,38.6897 37.33,38.2768 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 29.9903,39.8727L 29.9903,37.1536C 29.9903,36.5588 30.4725,36.0767 31.0673,36.0767L 31.0673,36.0767C 31.662,36.0767 32.1442,36.5588 32.1442,37.1536L 32.1442,39.8727C 32.1442,40.4674 31.662,40.9496 31.0673,40.9496L 31.0673,40.9496C 30.4725,40.9496 29.9903,40.4674 29.9903,39.8727 Z " />
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 34.8853,26.3532L 32.9444,28.2778L 29.2222,24.5556L 31.1699,22.6381C 32.6613,21.1517 33.4806,19.1723 33.4806,17.0716C 33.4806,15.8786 33.1934,14.7381 32.6864,13.6927L 31.0316,15.354C 30.5196,15.8661 28.9297,16.8741 27.2887,15.2331C 25.6476,13.592 26.8081,12.1486 27.3213,11.6355L 28.9744,9.98072C 27.9307,9.48185 26.7885,9.19302 25.6037,9.19302C 23.4999,9.19302 21.5192,10.0135 20.0324,11.5003L 18.1104,13.4437L 14.3755,9.73561L 16.3204,7.78996C 18.8853,5.22503 22.238,3.94339 25.6037,3.94339C 28.1227,3.94339 30.6482,4.66708 32.8406,6.1161L 38.1871,0.769646C 38.6991,0.257641 39.3653,3.8147e-006 40.0447,3.8147e-006C 40.7126,3.8147e-006 41.3854,0.257641 41.8974,0.769646C 42.9231,1.79529 42.9231,3.46257 41.8974,4.48821L 36.551,9.83466C 39.9299,14.9235 39.3719,21.8601 34.8853,26.3532 Z " />
                                                                </DrawingGroup>
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CheckStates">
                                                        <VisualState x:Name="Checked">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="Linked" Storyboard.TargetProperty="(UIElement.Visibility)">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Unchecked">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="NotLinked" Storyboard.TargetProperty="(UIElement.Visibility)">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Indeterminate" />
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                            </Grid>
                                        </ControlTemplate>
                                    </ToggleButton.Template>
                                    <ToggleButton.Style>
                                        <Style TargetType="{x:Type ToggleButton}">
                                            <Setter Property="ToolTip" Value="{localization:Localize KMediaPlayer_UnlinkMarkers}" />
                                            <Style.Triggers>
                                                <Trigger Property="IsChecked" Value="False">
                                                    <Setter Property="ToolTip" Value="{localization:Localize KMediaPlayer_LinkMarkers}" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ToggleButton.Style>
                                </ToggleButton>

                                <StackPanel Grid.Column="3"
                                            HorizontalAlignment="Center"
                                            Orientation="Horizontal">
                                    <RepeatButton x:Name="PART_Previous"
                                                  Margin="3"
                                                  VerticalAlignment="Center"
                                                  Command="{TemplateBinding PreviousCommand}"
                                                  Cursor="Hand"
                                                  Focusable="{TemplateBinding Focusable}"
                                                  ToolTip="{localization:Localize KMediaPlayer_StepBackward,
                                                                                  Shortcut=PlayerStepBackward}"
                                                  Visibility="{TemplateBinding JumpButtonsVisibility}">
                                        <RepeatButton.Template>
                                            <ControlTemplate>
                                                <Border Width="24" Height="24">
                                                    <Border.Background>
                                                        <DrawingBrush>
                                                            <DrawingBrush.Drawing>
                                                                <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 802.817,660.239L 807.647,660.239L 807.647,636.088L 802.817,636.088L 802.817,660.239 Z M 820.528,636.088L 820.528,660.239L 807.647,647.359L 820.528,636.088 Z " />
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Border.Background>
                                                </Border>
                                            </ControlTemplate>
                                        </RepeatButton.Template>
                                    </RepeatButton>

                                    <Grid>
                                        <Button x:Name="PART_Play"
                                                Grid.Column="3"
                                                Margin="3"
                                                VerticalAlignment="Center"
                                                Cursor="Hand"
                                                Focusable="{TemplateBinding Focusable}"
                                                ToolTip="{localization:Localize KMediaPlayer_Play,
                                                                                Shortcut=PlayerPlayPlause}">
                                            <Button.Template>
                                                <ControlTemplate>
                                                    <Border Width="24" Height="24">
                                                        <Border.Background>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 893.899,568.088L 893.899,592.239L 906.779,579.359L 893.899,568.088 Z " />
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Border.Background>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>

                                        <Button x:Name="PART_Pause"
                                                Grid.Column="3"
                                                Margin="3"
                                                VerticalAlignment="Center"
                                                Cursor="Hand"
                                                Focusable="{TemplateBinding Focusable}"
                                                ToolTip="{localization:Localize KMediaPlayer_Pause,
                                                                                Shortcut=PlayerPlayPlause}">
                                            <Button.Template>
                                                <ControlTemplate>
                                                    <Border Width="24" Height="24">
                                                        <Border.Background>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 902.587,622.573L 909.028,622.573L 909.028,598.422L 902.587,598.422L 902.587,622.573 Z M 891.317,622.573L 896.147,622.573L 896.147,598.422L 891.317,598.422L 891.317,622.573 Z " />
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Border.Background>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </Grid>

                                    <RepeatButton x:Name="PART_Next"
                                                  Grid.Column="5"
                                                  Margin="3"
                                                  VerticalAlignment="Center"
                                                  Command="{TemplateBinding NextCommand}"
                                                  Cursor="Hand"
                                                  Focusable="{TemplateBinding Focusable}"
                                                  ToolTip="{localization:Localize KMediaPlayer_StepForward,
                                                                                  Shortcut=PlayerStepForward}"
                                                  Visibility="{TemplateBinding JumpButtonsVisibility}">
                                        <RepeatButton.Template>
                                            <ControlTemplate>
                                                <Border Width="24" Height="24">
                                                    <Border.Background>
                                                        <DrawingBrush>
                                                            <DrawingBrush.Drawing>
                                                                <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 847.028,659.739L 842.198,659.739L 842.198,635.588L 847.028,635.588L 847.028,659.739 Z M 829.317,635.588L 829.317,659.739L 842.198,646.859L 829.317,635.588 Z " />
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Border.Background>
                                                </Border>
                                            </ControlTemplate>
                                        </RepeatButton.Template>
                                    </RepeatButton>
                                </StackPanel>

                                <TextBlock x:Name="PART_Position"
                                           Grid.Column="4"
                                           Margin="3"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           FontSize="14.667" />
                                <StackPanel Grid.Column="6"
                                            HorizontalAlignment="Right"
                                            Orientation="Horizontal">
                                    <Button x:Name="PART_Backward"
                                            Width="24"
                                            Margin="3"
                                            VerticalAlignment="Center"
                                            Cursor="Hand"
                                            Focusable="{TemplateBinding Focusable}"
                                            ToolTip="{localization:Localize KMediaPlayer_FastBackward}">
                                        <Button.Template>
                                            <ControlTemplate>
                                                <Border Width="24"
                                                        Height="24"
                                                        Background="Transparent">
                                                    <Border Width="24" Height="6">
                                                        <Border.Background>
                                                            <DrawingBrush>
                                                                <DrawingBrush.Drawing>
                                                                    <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="M0,0L53.333,0 53.333,8.888 0,8.888z" />
                                                                </DrawingBrush.Drawing>
                                                            </DrawingBrush>
                                                        </Border.Background>
                                                    </Border>
                                                </Border>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>

                                    <TextBlock Margin="3"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Text="{Binding SpeedRatio, ElementName=PART_MediaElement, StringFormat=x \{0:0.00\}}" />

                                    <Button x:Name="PART_Forward"
                                            Width="34"
                                            Margin="3"
                                            VerticalAlignment="Center"
                                            Cursor="Hand"
                                            Focusable="{TemplateBinding Focusable}"
                                            ToolTip="{localization:Localize KMediaPlayer_FastForward}">
                                        <Button.Template>
                                            <ControlTemplate>
                                                <Border Width="24" Height="24">
                                                    <Border.Background>
                                                        <DrawingBrush>
                                                            <DrawingBrush.Drawing>
                                                                <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="M19.833,0L32.501,0 32.501,19.833999 52.334,19.833999 52.334,32.500999 32.501,32.500999 32.501,52.333 19.833,52.333 19.833,32.500999 0,32.500999 0,19.833999 19.833,19.833999z" />
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Border.Background>
                                                </Border>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <Grid Margin="0,2,0,0"
                                  Panel.ZIndex="1"
                                  DockPanel.Dock="Bottom">
                                <ScrollViewer x:Name="PART_TimelineScrollViewer"
                                              BorderThickness="0"
                                              HorizontalScrollBarVisibility="Hidden"
                                              VerticalScrollBarVisibility="Hidden">
                                    <Grid Width="{TemplateBinding TimelineComputedWidth}" HorizontalAlignment="Left">
                                        <Slider x:Name="PART_TimeLine"
                                                Margin="0,10,0,10"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Top"
                                                Focusable="{TemplateBinding Focusable}"
                                                IsMoveToPointEnabled="True"
                                                LargeChange="10000"
                                                Maximum="{Binding MediaDuration, ElementName=PART_MediaElement, Mode=OneWay}"
                                                Orientation="Horizontal"
                                                SmallChange="1000" />

                                        <ListBox x:Name="PART_MarkersSelector"
                                                 Focusable="{TemplateBinding Focusable}"
                                                 ItemContainerStyle="{TemplateBinding MarkerItemContainerStyle}"
                                                 ItemsSource="{TemplateBinding Markers}"
                                                 SelectedItem="{Binding SelectedMarker, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}">
                                            <ListBox.Resources>

                                                <ControlTemplate x:Key="TopSlider" TargetType="{x:Type Slider}">
                                                    <Border BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            SnapsToDevicePixels="true">
                                                        <Grid>
                                                            <Track x:Name="PART_Track" Cursor="Hand">
                                                                <Track.Thumb>
                                                                    <Thumb x:Name="Thumb"
                                                                           Tag="{data:AncestorBinding DetailTemplate,
                                                                                                      {x:Type local:KMediaPlayer}}"
                                                                           ToolTipService.BetweenShowDelay="100"
                                                                           ToolTipService.InitialShowDelay="100"
                                                                           ToolTipService.ShowDuration="10000"
                                                                           ToolTipService.ShowOnDisabled="True">
                                                                        <Thumb.ToolTip>
                                                                            <ToolTip Margin="0,3"
                                                                                     Content="{Binding LabelOrWBS}"
                                                                                     ContentTemplate="{Binding Path=PlacementTarget.Tag, RelativeSource={x:Static RelativeSource.Self}}"
                                                                                     Placement="Top" />
                                                                        </Thumb.ToolTip>
                                                                        <Thumb.Template>
                                                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                                                <Polygon Width="17"
                                                                                         Height="17"
                                                                                         Fill="{Binding Background, RelativeSource={RelativeSource AncestorType={x:Type Slider}, Mode=FindAncestor}}"
                                                                                         Points="0,1 20,1 10,20"
                                                                                         SnapsToDevicePixels="True"
                                                                                         Stretch="Fill"
                                                                                         Stroke="#FF686868"
                                                                                         StrokeThickness="1" />
                                                                            </ControlTemplate>
                                                                        </Thumb.Template>
                                                                    </Thumb>
                                                                </Track.Thumb>
                                                            </Track>
                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>

                                                <ControlTemplate x:Key="BottomSlider" TargetType="{x:Type Slider}">
                                                    <Border BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            SnapsToDevicePixels="true">
                                                        <Grid>
                                                            <Track x:Name="PART_Track" Cursor="Hand">
                                                                <Track.Thumb>
                                                                    <Thumb x:Name="Thumb"
                                                                           Tag="{data:AncestorBinding DetailTemplate,
                                                                                                      {x:Type local:KMediaPlayer}}"
                                                                           ToolTipService.BetweenShowDelay="100"
                                                                           ToolTipService.InitialShowDelay="100"
                                                                           ToolTipService.ShowDuration="10000"
                                                                           ToolTipService.ShowOnDisabled="True">
                                                                        <Thumb.ToolTip>
                                                                            <ToolTip Margin="0,3"
                                                                                     Content="{Binding LabelOrWBS}"
                                                                                     ContentTemplate="{Binding Path=PlacementTarget.Tag, RelativeSource={x:Static RelativeSource.Self}}"
                                                                                     Placement="Bottom" />
                                                                        </Thumb.ToolTip>
                                                                        <Thumb.Template>
                                                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                                                <Polygon Width="17"
                                                                                         Height="17"
                                                                                         Fill="{Binding Background, RelativeSource={RelativeSource AncestorType={x:Type Slider}, Mode=FindAncestor}}"
                                                                                         Points="0,19 20,19 10,0"
                                                                                         SnapsToDevicePixels="True"
                                                                                         Stretch="Fill"
                                                                                         Stroke="#FF686868"
                                                                                         StrokeThickness="1" />
                                                                            </ControlTemplate>
                                                                        </Thumb.Template>
                                                                    </Thumb>
                                                                </Track.Thumb>
                                                            </Track>
                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>

                                            </ListBox.Resources>

                                            <ListBox.Style>
                                                <Style TargetType="{x:Type ListBox}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type ListBox}">
                                                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ListBox.Style>

                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid x:Name="MarkersGrid">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*" />
                                                            <RowDefinition Height="5" />
                                                            <RowDefinition Height="*" />
                                                        </Grid.RowDefinitions>

                                                        <local:KTimelineSlider x:Name="UpperSlider"
                                                                               BorderThickness="0"
                                                                               Focusable="{Binding Focusable, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}"
                                                                               IsUpper="True"
                                                                               Maximum="{Binding Duration, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:KMediaPlayer}, Mode=OneWay}"
                                                                               Template="{StaticResource TopSlider}">
                                                            <Slider.Background>
                                                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                    <GradientStop Offset="0" Color="#FFFDFDFD" />
                                                                    <GradientStop Offset="1" Color="#FF9D9D9E" />
                                                                </LinearGradientBrush>
                                                            </Slider.Background>
                                                        </local:KTimelineSlider>

                                                        <local:KTimelineSlider x:Name="LowerSlider"
                                                                               Grid.Row="2"
                                                                               BorderThickness="0"
                                                                               Focusable="{Binding Focusable, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}"
                                                                               IsUpper="False"
                                                                               Maximum="{Binding Duration, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:KMediaPlayer}, Mode=OneWay}"
                                                                               Template="{StaticResource BottomSlider}">
                                                            <Slider.Background>
                                                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                    <GradientStop Offset="0" Color="#FFFDFDFD" />
                                                                    <GradientStop Offset="1" Color="#FF9D9D9E" />
                                                                </LinearGradientBrush>
                                                            </Slider.Background>
                                                        </local:KTimelineSlider>

                                                    </Grid>

                                                    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType=ListBoxItem}}" Value="True">
                                                            <Setter TargetName="UpperSlider" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                        <GradientStop Offset="0.228" Color="#FFAECC07" />
                                                                        <GradientStop Offset="0.849" Color="#FF83B100" />
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter TargetName="LowerSlider" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                        <GradientStop Offset="0.228" Color="#FFAECC07" />
                                                                        <GradientStop Offset="0.849" Color="#FF83B100" />
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>

                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="UpperSlider" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                        <GradientStop Offset="0.254" Color="#FFFFC740" />
                                                                        <GradientStop Offset="0.496" Color="#FFFFB400" />
                                                                        <GradientStop Offset="1" Color="#FFFF9900" />
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter TargetName="LowerSlider" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                        <GradientStop Offset="0.254" Color="#FFFFC740" />
                                                                        <GradientStop Offset="0.496" Color="#FFFFB400" />
                                                                        <GradientStop Offset="1" Color="#FFFF9900" />
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </DataTemplate.Triggers>

                                                </DataTemplate>
                                            </ListBox.ItemTemplate>

                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <Grid />
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>

                                        </ListBox>

                                    </Grid>
                                </ScrollViewer>
                                <Border Margin="0,-22,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Background="#55000000"
                                        CornerRadius="4"
                                        Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TimelineLeftTimeFormatted, Converter={converters:NotNullToVisibilityConverter}}">
                                    <TextBlock Margin="2"
                                               Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TimelineLeftTimeFormatted}"
                                               TextWrapping="Wrap" />
                                </Border>
                                <Path Margin="0,-5,0,0"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Top"
                                      Fill="{StaticResource ControlBackgroundNormal}">
                                    <Path.Data>
                                        <PathGeometry Figures="M 0 0 L 0 6 L 6 0 Z" />
                                    </Path.Data>
                                    <Path.RenderTransform>
                                        <RotateTransform Angle="225" CenterX="3" CenterY="3" />
                                    </Path.RenderTransform>
                                </Path>
                                <Border Margin="0,-22,0,0"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Background="#55000000"
                                        CornerRadius="4"
                                        Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TimelineRightTimeFormatted, Converter={converters:NotNullToVisibilityConverter}}">
                                    <TextBlock Margin="2"
                                               Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TimelineRightTimeFormatted}"
                                               TextWrapping="Wrap" />
                                </Border>
                                <Path Margin="0,-5,0,0"
                                      HorizontalAlignment="Right"
                                      VerticalAlignment="Top"
                                      Fill="{StaticResource ControlBackgroundNormal}">
                                    <Path.Data>
                                        <PathGeometry Figures="M 0 0 L 0 6 L 6 0 Z" />
                                    </Path.Data>
                                    <Path.RenderTransform>
                                        <RotateTransform Angle="225" CenterX="3" CenterY="3" />
                                    </Path.RenderTransform>
                                </Path>
                            </Grid>

                            <Grid x:Name="VideoSurfaceGrid" MinHeight="40">
                                <local:KMediaElement x:Name="PART_MediaElement"
                                                     Width="Auto"
                                                     Height="Auto"
                                                     Margin="0,4,0,0"
                                                     Focusable="{TemplateBinding Focusable}"
                                                     LoadedBehavior="Pause"
                                                     Source="{TemplateBinding Source}"
                                                     SpeedRatio="1"
                                                     Stretch="Uniform"
                                                     UnloadedBehavior="Close"
                                                     Visibility="Hidden"
                                                     Volume="1" />

                                <Grid HorizontalAlignment="Stretch"
                                      VerticalAlignment="Stretch"
                                      Visibility="{Binding IsLoading, ElementName=PART_MediaElement, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">
                                    <Grid HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"
                                          Background="Black"
                                          Opacity=".4" />
                                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <TextBlock Foreground="White" Text="Loading..." />
                                    </Grid>
                                </Grid>

                                <ListBox x:Name="PART_VideosSelector"
                                         HorizontalAlignment="Stretch"
                                         VerticalAlignment="Stretch"
                                         HorizontalContentAlignment="Stretch"
                                         VerticalContentAlignment="Stretch"
                                         d:IsHidden="True"
                                         Background="#4C4E53"
                                         Focusable="{TemplateBinding Focusable}"
                                         ItemTemplate="{TemplateBinding SourcesTemplate}"
                                         ItemsSource="{TemplateBinding Sources}"
                                         ScrollViewer.CanContentScroll="True"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         SelectedValuePath="{TemplateBinding SourcesPath}"
                                         Style="{TemplateBinding VideosSelectorStyle}"
                                         Visibility="{TemplateBinding VideosSelectorVisibility}" />

                                <Button Width="40"
                                        Height="40"
                                        Padding="10"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Panel.ZIndex="9999"
                                        Command="{TemplateBinding ScreenModeCommand}"
                                        Cursor="Hand">
                                    <Button.Template>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border x:Name="Background"
                                                    Background="Transparent"
                                                    CornerRadius="5">
                                                <Rectangle Margin="{TemplateBinding Padding}" Fill="{StaticResource FullScreenBrush}" />
                                            </Border>

                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Background" Property="Background" Value="#66000000" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                    <Button.Style>
                                        <Style TargetType="{x:Type Button}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}" Value="true" />
                                                        <Condition Binding="{Binding ScreenModeVisibility, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:KMediaPlayer}}}" Value="Visible" />
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Image x:Name="PART_ThumbnailView" Visibility="Collapsed" />
                            </Grid>
                        </DockPanel>

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="State">
                                <VisualState x:Name="IsPlaying">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Play" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_MediaElement" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_VideosSelector" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="IsPaused">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pause" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_MediaElement" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_VideosSelector" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="IsStopped">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Pause" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_MediaElement" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <!--<ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_VideosSelector" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                        </ObjectAnimationUsingKeyFrames>-->
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="Volume">
                                <VisualState x:Name="IsOn">
                                    <!--
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="PART_Mute">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                    -->
                                </VisualState>
                                <VisualState x:Name="IsOff">
                                    <!--
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="PART_Volume">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                    -->
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Border>
                    <ControlTemplate.Triggers>

                        <DataTrigger Binding="{Binding HasSource, RelativeSource={RelativeSource Self}}" Value="False">
                            <Setter TargetName="VideoSurfaceGrid" Property="Grid.Background">
                                <Setter.Value>
                                    <DrawingBrush Stretch="Uniform">
                                        <DrawingBrush.RelativeTransform>
                                            <TransformGroup>
                                                <ScaleTransform CenterX="0.5" CenterY="0.5" ScaleX="0.85" ScaleY="0.85" />
                                                <SkewTransform CenterX="0.5" CenterY="0.5" />
                                                <RotateTransform CenterX="0.5" CenterY="0.5" />
                                                <TranslateTransform />
                                            </TransformGroup>
                                        </DrawingBrush.RelativeTransform>
                                        <DrawingBrush.Drawing>
                                            <GeometryDrawing Brush="#22FFFFFF" Geometry="F1 M 888.616,555.303L 888.616,562.22L 878.933,562.22L 878.933,555.303L 870.632,555.303L 870.632,558.07L 806.996,558.07L 806.996,555.303L 798.695,555.303L 798.695,562.22L 789.012,562.22L 789.012,555.303L 782.095,555.303L 782.095,667.358L 789.012,667.358L 789.012,660.441L 798.695,660.441L 798.695,667.358L 806.996,667.358L 806.996,664.591L 870.632,664.591L 870.632,667.358L 878.933,667.358L 878.933,660.441L 888.616,660.441L 888.616,667.358L 896.917,667.358L 896.917,555.303L 888.616,555.303 Z M 798.695,653.524L 789.012,653.524L 789.012,642.457L 798.695,642.457L 798.695,653.524 Z M 798.695,635.54L 789.012,635.54L 789.012,624.473L 798.695,624.473L 798.695,635.54 Z M 798.695,616.172L 789.012,616.172L 789.012,605.105L 798.695,605.105L 798.695,616.172 Z M 798.695,598.188L 789.012,598.188L 789.012,587.121L 798.695,587.121L 798.695,598.188 Z M 798.695,580.204L 789.012,580.204L 789.012,569.137L 798.695,569.137L 798.695,580.204 Z M 870.632,660.441L 806.996,660.441L 806.996,613.406L 870.632,613.406L 870.632,660.441 Z M 870.632,609.255L 806.996,609.255L 806.996,562.22L 870.632,562.22L 870.632,609.255 Z M 888.616,653.524L 878.933,653.524L 878.933,642.457L 888.616,642.457L 888.616,653.524 Z M 888.616,635.54L 878.933,635.54L 878.933,624.473L 888.616,624.473L 888.616,635.54 Z M 888.616,616.172L 878.933,616.172L 878.933,605.105L 888.616,605.105L 888.616,616.172 Z M 888.616,598.188L 878.933,598.188L 878.933,587.121L 888.616,587.121L 888.616,598.188 Z M 888.616,580.204L 878.933,580.204L 878.933,569.137L 888.616,569.137L 888.616,580.204 Z " />
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
