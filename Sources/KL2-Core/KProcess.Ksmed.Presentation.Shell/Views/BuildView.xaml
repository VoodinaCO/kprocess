<UserControl x:Class="KProcess.Ksmed.Presentation.Shell.Views.BuildView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:MahApps="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:charting="clr-namespace:System.Windows.Controls.DataVisualization.Charting;assembly=System.Windows.Controls.DataVisualization.Toolkit"
             xmlns:chartingprimitives="clr-namespace:System.Windows.Controls.DataVisualization.Charting.Primitives;assembly=System.Windows.Controls.DataVisualization.Toolkit"
             xmlns:converters="clr-namespace:KProcess.Ksmed.Presentation.Core.Converters;assembly=KProcess.Ksmed.Presentation.Core"
             xmlns:core="http://schemas.kprocess.com/xaml/core"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:datavis="clr-namespace:System.Windows.Controls.DataVisualization;assembly=System.Windows.Controls.DataVisualization.Toolkit"
             xmlns:hd="clr-namespace:DlhSoft.Windows.Controls;assembly=DlhSoft.HierarchicalData.LightWPF.Controls"
             xmlns:helpers="clr-namespace:KProcess.Presentation.Windows.Helpers;assembly=KProcess.Presentation.Windows"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             xmlns:ivm="clr-namespace:KProcess.Ksmed.Presentation.ViewModels;assembly=KProcess.Ksmed.Presentation.ViewModels.Interfaces"
             xmlns:k="http://schemas.kprocess.com/xaml/framework"
             xmlns:local="clr-namespace:KProcess.Ksmed.Presentation.Shell"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="clr-namespace:KProcess.Ksmed.Models;assembly=KProcess.Ksmed.Models"
             xmlns:pdgcc="clr-namespace:DlhSoft.Windows.Controls;assembly=DlhSoft.ProjectData.GanttChart.LightWPF.Controls"
             xmlns:presentation="clr-namespace:KProcess.Presentation.Windows.Converters;assembly=KProcess.Presentation.Windows"
             xmlns:views="clr-namespace:KProcess.Ksmed.Presentation.Shell.Views"
             xmlns:vm="clr-namespace:KProcess.Ksmed.Presentation.ViewModels"
             xmlns:wpftoolkit="http://schemas.xceed.com/wpf/xaml/toolkit"
             d:DesignHeight="576"
             d:DesignWidth="1008"
             mc:Ignorable="d">
    <!--  d:DataContext="{d:DesignInstance IsDesignTimeCreatable=True, Type={x:Type vm:AnalyzeBuildViewModel}}"  -->
    <UserControl.Resources>
        <core:MultiGanttZoomer x:Key="Zoomer" />

        <Style x:Key="LabelStyle" TargetType="{x:Type TextBlock}">
            <Setter Property="Margin" Value="2,4,2,2" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="ReferentialComboBoxItemStyle"
               BasedOn="{StaticResource comboBoxItemStyleBase}"
               TargetType="{x:Type ComboBoxItem}">
            <Setter Property="ToolTip" Value="{Binding DescriptionOrLabel}" />
        </Style>

        <views:ActionGanttItemIconTemplateSelector x:Key="actionGanttItemIconTemplateSelector" />

    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition MinHeight="150" />
            <RowDefinition Height="5" />
            <RowDefinition Height="178" MinHeight="130" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <i:Interaction.Behaviors>
            <core:GridLayoutPersistanceBehavior />
        </i:Interaction.Behaviors>

        <core:FixedGridSplitter Grid.Row="1"
                                Grid.ColumnSpan="2"
                                Height="2"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Style="{StaticResource horizontalGridSplitterStyle}" />

        <StackPanel Grid.ColumnSpan="2"
                    VerticalAlignment="Top"
                    Orientation="Horizontal">

            <StackPanel VerticalAlignment="Stretch" Orientation="Horizontal">
                <Button Command="{Binding MoveUpCommand}"
                        Style="{DynamicResource ButtonUpSmallStyle}"
                        ToolTip="{k:Localize View_AnalyzeGridCommon_MoveUp}" />
                <Button Command="{Binding MoveDownCommand}"
                        Style="{DynamicResource ButtonDownSmallStyle}"
                        ToolTip="{k:Localize View_AnalyzeGridCommon_MoveDown}" />
                <Button Click="CollapseAll_Click"
                        Style="{DynamicResource ButtonFolderMinusSmallStyle}"
                        ToolTip="{k:Localize View_AnalyzeGridCommon_CollapseAll}" />
                <Button Click="ExpandAll_Click"
                        Style="{DynamicResource ButtonFolderPlusSmallStyle}"
                        ToolTip="{k:Localize View_AnalyzeGridCommon_ExpandAll}" />

                <ItemsControl Style="{StaticResource ExtBarActionsSmall}" />

            </StackPanel>


            <Border Margin="4,2"
                    VerticalAlignment="Stretch"
                    Background="{DynamicResource DarkControlBackgroundBrush}"
                    CornerRadius="2">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Margin="4"
                               VerticalAlignment="Center"
                               Text="{k:Localize View_AnalyzeGridCommon_ViewBy}" />
                    <ComboBox MinWidth="120"
                              Margin="4"
                              VerticalAlignment="Center"
                              DisplayMemberPath="Label"
                              ItemsSource="{Binding Views}"
                              SelectedItem="{Binding ViewContainer}"
                              SelectionChanged="OnViewSelectionChanged">
                        <ComboBox.ItemContainerStyle>
                            <Style BasedOn="{StaticResource comboBoxItemStyleBase}" TargetType="{x:Type ComboBoxItem}">
                                <Setter Property="Visibility" Value="{Binding Visibility}" />
                            </Style>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                </StackPanel>
            </Border>
            <ListBox Margin="4,2"
                     VerticalAlignment="Stretch"
                     Background="{DynamicResource DarkControlBackgroundBrush}"
                     DisplayMemberPath="Label"
                     ItemsSource="{Binding IESFilters}"
                     ScrollViewer.CanContentScroll="False"
                     SelectedItem="{Binding SelectedIESFilter}"
                     Style="{StaticResource radioListBoxStyle}"
                     Visibility="{Binding IESFilterVisibility}">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
            </ListBox>

        </StackPanel>


        <StackPanel Grid.Row="0"
                    Grid.Column="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Orientation="Horizontal">
            <TextBlock Style="{StaticResource LabelStyle}"
                       Text="{Binding TotalDuration, StringFormat={k:Localize View_AnalyzeBuild_TotalDuration}, Converter={StaticResource TicksToStringConverter}}"
                       TextWrapping="Wrap" />
            <Button Click="AutoZoomHorizontal_Click"
                    Style="{DynamicResource ButtonAutoScaleHorizontalSmallStyle}"
                    ToolTip="{k:Localize View_AnalyzeGridCommon_ZoomAutoX}" />
            <Button Click="AutoZoomVertical_Click"
                    Style="{DynamicResource ButtonAutoScaleVerticalRevertSmallStyle}"
                    ToolTip="{k:Localize View_AnalyzeGridCommon_ZoomAutoY}" />
            <Button Click="AutoZoomVerticalRevert_Click"
                    Style="{DynamicResource ButtonAutoScaleVerticalSmallStyle}"
                    ToolTip="{k:Localize View_AnalyzeGridCommon_ZoomAutoXReverse}" />
            <Button Click="AutoZoomBoth_Click"
                    Style="{DynamicResource ButtonAutoScaleBothSmallStyle}"
                    ToolTip="{k:Localize View_AnalyzeGridCommon_ZoomAutoXY}" />
            <ToggleButton x:Name="PredecessorsLinks"
                          Checked="PredecessorsLinks_CheckedChanged"
                          Style="{DynamicResource ToggleButtonLinksSmallStyle}"
                          ToolTip="{k:Localize View_AnalyzeGridCommon_ShowPredecessorsLinks}"
                          Unchecked="PredecessorsLinks_CheckedChanged" />
        </StackPanel>

        <core:KGanttChartDataGrid x:Name="analyzeBuildGrid"
                                  Grid.Row="0"
                                  Grid.ColumnSpan="2"
                                  Margin="0,35,0,4"
                                  CurrentTimelinePosition="{Binding CurrentTimelinePosition, Mode=TwoWay, Converter={StaticResource GanttTicksToDateTimeConverter}}"
                                  DependencyCreationValidator="{Binding DependencyCreationValidator}"
                                  EnableRowVirtualization="True"
                                  IsReadOnly="{Binding IsReadOnly}"
                                  Items="{Binding ActionItems}"
                                  SelectedItem="{Binding CurrentGridItem, Mode=TwoWay}"
                                  Style="{StaticResource baseGanttChartDataGridStyle}"
                                  TaskGanttClickCommand="{Binding SelectGanttItemCommand}">
            <pdgcc:GanttChartDataGrid.ItemContainerStyle>
                <Style TargetType="{x:Type DataGridRow}">
                    <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                </Style>
            </pdgcc:GanttChartDataGrid.ItemContainerStyle>
            <i:Interaction.Behaviors>
                <core:KSmedDataGridBehavior x:Name="GridBehavior" CurrentView="{Binding View}" />
                <core:ExportGridBehavior />
                <core:BringIntoViewSelectionBehavior />
                <core:WheelZoomableBehavior ExternalZoomable="{StaticResource Zoomer}" />
                <core:DataGridRowDoubleClickCommandBehavior Command="{Binding PlayCurrentAction}" ExpectedDataContext="{x:Type ivm:ActionGanttItem}" />
            </i:Interaction.Behaviors>

            <core:KGanttChartDataGrid.Resources>
                <DataTemplate x:Key="ActionGanttItemWithoutLinkedProcessIconTemplate" DataType="{x:Type ivm:ActionGanttItem}">
                    <Grid Background="Transparent">
                        <Border Background="{Binding VideoColor}" Visibility="{Binding VideoName, Converter={StaticResource NotNullToVisibilityConverter}}">
                            <Rectangle>
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <GeometryDrawing Brush="{StaticResource ControlBackgroundNormal}" Geometry="F1 M 888.616,555.303L 888.616,562.22L 878.933,562.22L 878.933,555.303L 870.632,555.303L 870.632,558.07L 806.996,558.07L 806.996,555.303L 798.695,555.303L 798.695,562.22L 789.012,562.22L 789.012,555.303L 782.095,555.303L 782.095,667.358L 789.012,667.358L 789.012,660.441L 798.695,660.441L 798.695,667.358L 806.996,667.358L 806.996,664.591L 870.632,664.591L 870.632,667.358L 878.933,667.358L 878.933,660.441L 888.616,660.441L 888.616,667.358L 896.917,667.358L 896.917,555.303L 888.616,555.303 Z M 798.695,653.524L 789.012,653.524L 789.012,642.457L 798.695,642.457L 798.695,653.524 Z M 798.695,635.54L 789.012,635.54L 789.012,624.473L 798.695,624.473L 798.695,635.54 Z M 798.695,616.172L 789.012,616.172L 789.012,605.105L 798.695,605.105L 798.695,616.172 Z M 798.695,598.188L 789.012,598.188L 789.012,587.121L 798.695,587.121L 798.695,598.188 Z M 798.695,580.204L 789.012,580.204L 789.012,569.137L 798.695,569.137L 798.695,580.204 Z M 870.632,660.441L 806.996,660.441L 806.996,613.406L 870.632,613.406L 870.632,660.441 Z M 870.632,609.255L 806.996,609.255L 806.996,562.22L 870.632,562.22L 870.632,609.255 Z M 888.616,653.524L 878.933,653.524L 878.933,642.457L 888.616,642.457L 888.616,653.524 Z M 888.616,635.54L 878.933,635.54L 878.933,624.473L 888.616,624.473L 888.616,635.54 Z M 888.616,616.172L 878.933,616.172L 878.933,605.105L 888.616,605.105L 888.616,616.172 Z M 888.616,598.188L 878.933,598.188L 878.933,587.121L 888.616,587.121L 888.616,598.188 Z M 888.616,580.204L 878.933,580.204L 878.933,569.137L 888.616,569.137L 888.616,580.204 Z " />
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Border>
                        <Image Width="12"
                               Height="12"
                               Margin="2"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Bottom"
                               Source="pack://siteoforigin:,,,/Resources/Images/Picture.png"
                               Visibility="{Binding Action.Thumbnail, Converter={StaticResource NotNullToVisibilityConverter}}" />
                    </Grid>
                </DataTemplate>
                <DataTemplate x:Key="ActionGanttItemWithLinkedProcessIconTemplate" DataType="{x:Type ivm:ActionGanttItem}">
                    <iconPacks:PackIconFontAwesome HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Kind="CogsSolid" />
                </DataTemplate>
            </core:KGanttChartDataGrid.Resources>

            <pdgcc:GanttChartDataGrid.Columns>

                <pdgcc:DataGridColumnCollection>

                    <DataGridTemplateColumn x:Name="ColumnVideo"
                                            core:KSmedDataGridBehavior.Id="video"
                                            core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnVideo"
                                            CellTemplateSelector="{StaticResource actionGanttItemIconTemplateSelector}"
                                            IsReadOnly="True">
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding VideoName}" Header="{k:Localize View_AnalyzeAcquire_Column_Video}" />
                        </i:Interaction.Behaviors>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn x:Name="ColumnWBS"
                                            core:KSmedDataGridBehavior.Id="wbs"
                                            core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnWBS"
                                            Header="{k:Localize View_AnalyzeAcquire_Column_WBS}"
                                            IsReadOnly="True">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Padding="2"
                                           VerticalAlignment="Center"
                                           Text="{Binding Action.WBS}">
                                    <TextBlock.ToolTip>
                                        <ToolTip>
                                            <StackPanel>
                                                <TextBlock>
                                                    <TextBlock.Text>
                                                        <MultiBinding Converter="{core:ThumbnailTooltipHeaderConverter}">
                                                            <Binding Path="VideoName" />
                                                            <Binding Path="Action.WBS" />
                                                        </MultiBinding>
                                                    </TextBlock.Text>
                                                </TextBlock>
                                                <Image MaxWidth="{Binding Converter={core:ImageResizerConverter}}"
                                                       MaxHeight="{Binding Converter={core:ImageResizerConverter}}"
                                                       Source="{Binding Action.Thumbnail.Uri}"
                                                       Stretch="Uniform" />
                                            </StackPanel>
                                        </ToolTip>
                                    </TextBlock.ToolTip>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.WBS}" />
                        </i:Interaction.Behaviors>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn x:Name="ColumnKeyTask"
                                            Width="20"
                                            core:KSmedDataGridBehavior.Id="IsKeyTaskManaged"
                                            core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnKeyTask"
                                            Header="{k:Localize View_AnalyzeAcquire_IsKeyTask}"
                                            IsReadOnly="True">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border x:Name="PackIcon"
                                        HorizontalAlignment="Center"
                                        ToolTip="{k:Localize View_AnalyzeAcquire_IsKeyTask}"
                                        Visibility="Collapsed">
                                    <iconPacks:PackIconFontAwesome HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center"
                                                                   Kind="ExclamationSolid" />
                                </Border>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Action.IsKeyTaskManaged}" Value="True">
                                        <Setter TargetName="PackIcon" Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.IsKeyTaskManaged}" />
                        </i:Interaction.Behaviors>
                    </DataGridTemplateColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnTask"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Label"
                                           core:KSmedDataGridBehavior.Id="task"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnTask"
                                           CellTemplate="{StaticResource TaskCellTemplate}"
                                           Header="{k:Localize View_AnalyzeAcquire_Column_Task}"
                                           IsReadOnly="true">
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.Label}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnDuration"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathDisplayConverter="{StaticResource TicksToStringConverter}"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="BuildDuration"
                                           core:KSmedDataGridBehavior.Id="duration"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnDuration"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{k:Localize View_AnalyzeAcquire_Column_Duration}"
                                           IsReadOnly="True">
                        <hd:DataTreeGridColumn.HeaderStyle>
                            <Style BasedOn="{StaticResource baseDataGridColumnHeaderStyle}" TargetType="DataGridColumnHeader">
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <ContentControl Content="{Binding}">
                                                <ToolTipService.ToolTip>
                                                    <ToolTip Content="HH:MM:SS" />
                                                </ToolTipService.ToolTip>
                                            </ContentControl>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </hd:DataTreeGridColumn.HeaderStyle>
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding ManagedDuration, Converter={StaticResource TicksToStringConverter}}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding ManagedDuration, Converter={StaticResource TicksToStringConverter}}" CellDataType="TimeSpan" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <core:KDataGridCheckBoxColumn x:Name="ColumnIsRandom"
                                                  core:KSmedDataGridBehavior.Id="isRandom"
                                                  core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnIsRandom"
                                                  Binding="{Binding Action.IsRandom}"
                                                  CellStyle="{StaticResource DataGridCellSingleClickEditStyle}"
                                                  ElementStyle="{StaticResource GanttGridVisibleWhenNotGroupCheckBoxElementStyle}"
                                                  IsReadOnly="True"
                                                  Visibility="Collapsed">
                        <core:KDataGridCheckBoxColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Path Width="{Binding (TextElement.FontSize), RelativeSource={RelativeSource FindAncestor, AncestorType=Grid}}"
                                          Height="{Binding (TextElement.FontSize), RelativeSource={RelativeSource FindAncestor, AncestorType=Grid}}"
                                          Margin="1,0,0,0"
                                          HorizontalAlignment="Left"
                                          Data="M307 384h120v-213h-150l-8 42h-120v-149h-42v363h192z"
                                          Fill="{Binding (TextElement.Foreground), RelativeSource={RelativeSource FindAncestor, AncestorType=Grid}}"
                                          RenderTransformOrigin="0.5,0.5"
                                          Stretch="Uniform">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleY="-1" />
                                        </Path.RenderTransform>
                                    </Path>
                                </Grid>
                            </DataTemplate>
                        </core:KDataGridCheckBoxColumn.HeaderTemplate>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.IsRandom}" />
                        </i:Interaction.Behaviors>
                    </core:KDataGridCheckBoxColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnCategory"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathDisplay="Category.Label"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Category.Id"
                                           core:KSmedDataGridBehavior.Id="category"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnCategory"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Category}"
                                           IsReadOnly="True">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.Category.Label}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.Category.Label}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnSkill"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathDisplay="Skill.Label"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Skill.Id"
                                           core:KSmedDataGridBehavior.Id="skill"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnSkill"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Skill}"
                                           IsReadOnly="True">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.Skill.Label}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.Skill.Label}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnResource"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathDisplay="Resource.Label"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Resource.Id"
                                           core:KSmedDataGridBehavior.Id="resource"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnResource"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{k:Localize View_AnalyzeAcquire_Column_Resource}"
                                           IsReadOnly="True">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.Resource.Label}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.Reduced.Resource.Label}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <core:KDataGridTextColumn x:Name="ColumnPredecessors"
                                              core:KSmedDataGridBehavior.Id="predecessors"
                                              core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnPredecessors"
                                              Binding="{Binding PredecessorsString}"
                                              CellStyle="{StaticResource DataGridCellPredecessorsSingleClickEditStyle}"
                                              EditingElementStyle="{StaticResource GanttGridVisibleWhenNotGroupTextBoxStyle}"
                                              ElementStyle="{StaticResource GanttGridVisibleWhenNotGroupTextBlockStyle}"
                                              Header="{k:Localize View_AnalyzeAcquire_Column_Predecessors}">
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding PredecessorsString}" />
                        </i:Interaction.Behaviors>
                    </core:KDataGridTextColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef1"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref1"
                                           core:KSmedDataGridBehavior.Id="ref1"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef1"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref1}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref1Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref1Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef2"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref2"
                                           core:KSmedDataGridBehavior.Id="ref2"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef2"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref2}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref2Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref2Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef3"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref3"
                                           core:KSmedDataGridBehavior.Id="ref3"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef3"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref3}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref3Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref3Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef4"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref4"
                                           core:KSmedDataGridBehavior.Id="ref4"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef4"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref4}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref4Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref4Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef5"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref5"
                                           core:KSmedDataGridBehavior.Id="ref5"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef5"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref5}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref5Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref5Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef6"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref6"
                                           core:KSmedDataGridBehavior.Id="ref6"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef6"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref6}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref6Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref6Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn x:Name="ColumnRef7"
                                           core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="Ref7"
                                           core:KSmedDataGridBehavior.Id="ref7"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnRef7"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           Header="{x:Static core:ReferentialsUse.Ref7}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Ref7Labels}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Ref7Labels}" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <core:KDataGridTextColumn x:Name="ColumnAmeliorationDescription"
                                              core:KSmedDataGridBehavior.Id="ameliorationDescription"
                                              core:PersistDatagridColumnWidthBehavior.ColumnKey="ColumnAmeliorationDescription"
                                              Binding="{Binding Action.AmeliorationDescription}"
                                              ElementStyle="{StaticResource GanttGridVisibleWhenNotGroupTextBlockStyle}"
                                              Header="{k:Localize View_AnalyzeAcquire_Column_Improvement}"
                                              IsReadOnly="True"
                                              Visibility="Collapsed">
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.AmeliorationDescription}" />
                        </i:Interaction.Behaviors>
                    </core:KDataGridTextColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomTextValue"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomTextLabelColumn1"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomTextValue}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomTextValue}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Text" Index="1" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomTextValue2"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomTextLabelColumn2"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomTextValue2}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomTextValue2}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Text" Index="2" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomTextValue3"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomTextLabelColumn3"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomTextValue3}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomTextValue3}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Text" Index="3" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomTextValue4"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomTextLabelColumn4"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomTextValue4}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomTextValue4}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Text" Index="4" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>


                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomNumericValue"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomNumLabelColumn1"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomNumericValueText, Converter={core:DecimalConverter}}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomNumericValue}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Numeric" Index="1" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomNumericValue2"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomNumLabelColumn2"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomNumericValue2Text, Converter={core:DecimalConverter}}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomNumericValue2}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Numeric" Index="2" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomNumericValue3"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomNumLabelColumn3"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomNumericValue3Text, Converter={core:DecimalConverter}}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomNumericValue3}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Numeric" Index="3" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                    <hd:DataTreeGridColumn core:KDataGridFeatures.CellVisibleWhenNotGroup="True"
                                           core:KDataGridFeatures.HighlightWhenChildOverridenKActionPropertyPathValue="CustomNumericValue4"
                                           core:PersistDatagridColumnWidthBehavior.ColumnKey="CustomNumLabelColumn4"
                                           CellTemplate="{StaticResource FeaturedCellTemplate}"
                                           IsReadOnly="True"
                                           Visibility="Collapsed">
                        <core:KDataGridFeatures.Binding>
                            <core:KDataGridBindingDescription Value="{Binding Action.CustomNumericValue4Text, Converter={core:DecimalConverter}}" />
                        </core:KDataGridFeatures.Binding>
                        <i:Interaction.Behaviors>
                            <core:ExportFormatBehavior Binding="{Binding Action.CustomNumericValue4}" />
                            <core:KDataGridCustomLabelColumnBehavior FieldType="Numeric" Index="4" />
                        </i:Interaction.Behaviors>
                    </hd:DataTreeGridColumn>

                </pdgcc:DataGridColumnCollection>
            </pdgcc:GanttChartDataGrid.Columns>
        </core:KGanttChartDataGrid>

        <DataGrid x:Name="solutionsDataGrid"
                  Grid.ColumnSpan="2"
                  Margin="0,35,0,4"
                  d:IsHidden="True"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  IsReadOnly="{Binding IsReadOnly}"
                  ItemsSource="{Binding SolutionsWrappers}"
                  ScrollViewer.CanContentScroll="False"
                  Visibility="{Binding SolutionsVisibility}">
            <i:Interaction.Behaviors>
                <core:ExportGridBehavior />
                <core:DataGridCellCommitBehavior />
                <core:PersistDatagridColumnWidthBehavior DataGridKey="solutionsDataGrid" />
            </i:Interaction.Behaviors>

            <DataGrid.ItemContainerStyle>
                <Style TargetType="{x:Type DataGridRow}">
                    <Setter Property="IsEnabled" Value="{Binding IsNotReadOnly}" />
                </Style>
            </DataGrid.ItemContainerStyle>

            <DataGrid.Columns>
                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="Index"
                                          Binding="{Binding Index}"
                                          IsReadOnly="True">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Index}" Header="" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionScenarioLabel"
                                          Binding="{Binding Solution.Scenario.Label}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Scenario}"
                                          IsReadOnly="True">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Scenario.Label}" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionDescription"
                                          Binding="{Binding Solution.SolutionDescription}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Solution}"
                                          IsReadOnly="True">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.SolutionDescription}" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="RelatedActions"
                                          Binding="{Binding RelatedActions}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_RelatedActions}"
                                          IsReadOnly="True">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding RelatedActions}" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="Saving"
                                          Binding="{Binding Saving, Converter={StaticResource TicksToStringConverter}}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Saving}"
                                          IsReadOnly="True">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Saving, Converter={StaticResource TicksToStringConverter}}" CellDataType="TimeSpan" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionInvestment"
                                          Binding="{Binding Solution.Investment, TargetNullValue=''}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Investment}">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Investment}" CellDataType="Number" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="IG"
                                          Binding="{Binding IG, StringFormat=F}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_IG}"
                                          IsReadOnly="True">
                    <core:KDataGridTextColumn.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding .}" ToolTip="{k:Localize View_RestitutionSolutions_Columns_IG_Tooltip}" />
                        </DataTemplate>
                    </core:KDataGridTextColumn.HeaderTemplate>
                    <core:KDataGridTextColumn.CellStyle>
                        <Style BasedOn="{StaticResource baseDataGridCellStyle}" TargetType="{x:Type DataGridCell}">
                            <Setter Property="ToolTip" Value="{k:Localize View_RestitutionSolutions_Columns_IG_Tooltip}" />
                        </Style>
                    </core:KDataGridTextColumn.CellStyle>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding IG, StringFormat=F}" CellDataType="Number" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionDifficulty"
                                          Binding="{Binding Solution.Difficulty, TargetNullValue=''}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Diffculty}">
                    <core:KDataGridTextColumn.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding .}" ToolTip="{k:Localize View_RestitutionSolutions_Columns_Difficulty_Tooltip}" />
                        </DataTemplate>
                    </core:KDataGridTextColumn.HeaderTemplate>
                    <core:KDataGridTextColumn.CellStyle>
                        <Style BasedOn="{StaticResource baseDataGridCellStyle}" TargetType="{x:Type DataGridCell}">
                            <Setter Property="ToolTip" Value="{k:Localize View_RestitutionSolutions_Columns_Difficulty_Tooltip}" />
                        </Style>
                    </core:KDataGridTextColumn.CellStyle>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Difficulty}" CellDataType="Number" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionCost"
                                          Binding="{Binding Solution.Cost, TargetNullValue=''}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Cost}">
                    <core:KDataGridTextColumn.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding .}" ToolTip="{k:Localize View_RestitutionSolutions_Columns_Cost_Tooltip}" />
                        </DataTemplate>
                    </core:KDataGridTextColumn.HeaderTemplate>
                    <core:KDataGridTextColumn.CellStyle>
                        <Style BasedOn="{StaticResource baseDataGridCellStyle}" TargetType="{x:Type DataGridCell}">
                            <Setter Property="ToolTip" Value="{k:Localize View_RestitutionSolutions_Columns_Cost_Tooltip}" />
                        </Style>
                    </core:KDataGridTextColumn.CellStyle>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Cost}" CellDataType="Number" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="DCG"
                                          Binding="{Binding DCG, StringFormat=F}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_DCG}"
                                          IsReadOnly="True">
                    <core:KDataGridTextColumn.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding .}" ToolTip="{k:Localize View_RestitutionSolutions_Columns_DCG_Tooltip}" />
                        </DataTemplate>
                    </core:KDataGridTextColumn.HeaderTemplate>
                    <core:KDataGridTextColumn.CellStyle>
                        <Style BasedOn="{StaticResource baseDataGridCellStyle}" TargetType="{x:Type DataGridCell}">
                            <Setter Property="ToolTip" Value="{k:Localize View_RestitutionSolutions_Columns_DCG_Tooltip}" />
                        </Style>
                    </core:KDataGridTextColumn.CellStyle>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding DCG, StringFormat=F}" CellDataType="Number" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>

                <core:KDataGridCheckBoxColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionApproved"
                                              Binding="{k:InstantBinding Solution.Approved}"
                                              CellStyle="{StaticResource DataGridCellSingleClickEditStyle}"
                                              Header="{k:Localize View_RestitutionSolutions_Columns_OK}">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Approved}" />
                    </i:Interaction.Behaviors>
                </core:KDataGridCheckBoxColumn>

                <DataGridTemplateColumn Width="Auto"
                                        MinWidth="50"
                                        Header="{k:Localize View_AnalyzeBuild_Who}">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <TextBox Height="23"
                                         Margin="2"
                                         VerticalAlignment="Center"
                                         IsReadOnly="{Binding DataContext.IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                         Text="{Binding Solution.Who, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Who}" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionWhen" Header="{k:Localize View_AnalyzeBuild_When}">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <DatePicker Height="23"
                                            Margin="2"
                                            VerticalAlignment="Center"
                                            DisplayDateStart="{Binding DataContext.Today, RelativeSource={RelativeSource FindAncestor, AncestorType=DataGrid}, Mode=OneWay}"
                                            IsEnabled="{Binding DataContext.IsReadOnly, Converter={k:NegatedBooleanConverter}, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                            SelectedDate="{Binding Solution.When, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.When}" CellDataType="Date" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="65" Header="P">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <wpftoolkit:DecimalUpDown Height="23"
                                                          Margin="2"
                                                          VerticalAlignment="Center"
                                                          FormatString="P0"
                                                          Increment="0.05"
                                                          IsReadOnly="{Binding DataContext.IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                                          Maximum="1"
                                                          Minimum="0"
                                                          Value="{Binding Solution.P, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.P}" CellDataType="Percentage" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="65" Header="D">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <wpftoolkit:DecimalUpDown Height="23"
                                                          Margin="2"
                                                          VerticalAlignment="Center"
                                                          FormatString="P0"
                                                          Increment="0.05"
                                                          IsReadOnly="{Binding DataContext.IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                                          Maximum="1"
                                                          Minimum="0"
                                                          Value="{Binding Solution.D, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.D}" CellDataType="Percentage" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="65" Header="C">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <wpftoolkit:DecimalUpDown Height="23"
                                                          Margin="2"
                                                          VerticalAlignment="Center"
                                                          FormatString="P0"
                                                          Increment="0.05"
                                                          IsReadOnly="{Binding DataContext.IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                                          Maximum="1"
                                                          Minimum="0"
                                                          Value="{Binding Solution.C, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.C}" CellDataType="Percentage" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="65" Header="A">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <wpftoolkit:DecimalUpDown Height="23"
                                                          Margin="2"
                                                          VerticalAlignment="Center"
                                                          FormatString="P0"
                                                          Increment="0.05"
                                                          IsReadOnly="{Binding DataContext.IsReadOnly, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                                          Maximum="1"
                                                          Minimum="0"
                                                          Value="{Binding Solution.A, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.A}" CellDataType="Percentage" />
                    </i:Interaction.Behaviors>
                </DataGridTemplateColumn>

                <core:KDataGridTextColumn core:PersistDatagridColumnWidthBehavior.ColumnKey="SolutionComments"
                                          Binding="{Binding Solution.Comments}"
                                          Header="{k:Localize View_RestitutionSolutions_Columns_Comments}">
                    <i:Interaction.Behaviors>
                        <core:ExportFormatBehavior Binding="{Binding Solution.Comments}" />
                    </i:Interaction.Behaviors>
                </core:KDataGridTextColumn>
            </DataGrid.Columns>

        </DataGrid>


        <Border Grid.ColumnSpan="2"
                Margin="0,32,0,0"
                d:IsHidden="True"
                Background="{DynamicResource CheckBoxInnerShadowBrush}"
                Visibility="{Binding GridWaitVisibility}">
            <Control Foreground="{DynamicResource ControlBackgroundOverOrange}"
                     RenderTransformOrigin="0.5,0.5"
                     Style="{StaticResource spinnerStyle}">
                <Control.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform ScaleX="5" ScaleY="5" />
                        <SkewTransform />
                        <RotateTransform />
                        <TranslateTransform />
                    </TransformGroup>
                </Control.RenderTransform>
            </Control>
        </Border>

        <Grid Grid.Row="2" Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <i:Interaction.Behaviors>
                <core:GridLayoutPersistanceBehavior />
            </i:Interaction.Behaviors>

            <GridSplitter Grid.Column="1"
                          Width="2"
                          Padding="0"
                          HorizontalAlignment="Left"
                          Style="{StaticResource verticalGridSplitterStyle}" />
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width=".45*" />
                    <ColumnDefinition Width=".55*" MaxWidth="400" />
                </Grid.ColumnDefinitions>

                <Grid Margin="4,2,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Row="0"
                                Margin="2"
                                Orientation="Horizontal">
                        <Button ToolTip="{k:Localize View_AnalyzeBuild_PlayAction}">
                            <Button.Command>
                                <MultiBinding Converter="{core:BoolToCommandConverter}">
                                    <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                    <Binding Converter="{core:EqualsEnumConverter}"
                                             ConverterParameter="{x:Static vm:PlayingSource.Action}"
                                             Path="PlayingSource" />
                                    <Binding Path="PauseCommand" />
                                    <Binding Path="PlayCurrentAction" />
                                </MultiBinding>
                            </Button.Command>
                            <StackPanel Orientation="Horizontal">
                                <Path Width="10"
                                      Height="10"
                                      Data="F1 M 0,0 2,1 0,2 Z"
                                      Fill="{DynamicResource InputForegroundBrush}"
                                      Stretch="Fill">
                                    <Path.Visibility>
                                        <MultiBinding Converter="{presentation:NegatedBooleansToVisibilityConverter}">
                                            <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                            <Binding Converter="{core:EqualsEnumConverter}"
                                                     ConverterParameter="{x:Static vm:PlayingSource.Action}"
                                                     Path="PlayingSource" />
                                        </MultiBinding>
                                    </Path.Visibility>
                                </Path>
                                <Path Width="10"
                                      Height="10"
                                      Data="F1 M 0,0L 5,0L 5,25L 0,25L 0,0 Z M 11.5,0L 16.5,0L 16.5,25L 11.5,25L 11.5,0 Z"
                                      Fill="{DynamicResource InputForegroundBrush}"
                                      Stretch="Fill">
                                    <Path.Visibility>
                                        <MultiBinding Converter="{presentation:BooleansToVisibilityConverter}">
                                            <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                            <Binding Converter="{core:EqualsEnumConverter}"
                                                     ConverterParameter="{x:Static vm:PlayingSource.Action}"
                                                     Path="PlayingSource" />
                                        </MultiBinding>
                                    </Path.Visibility>
                                </Path>
                                <TextBlock Margin="2,0,0,0" Text="{k:Localize View_AnalyzeBuild_PlayAction_Short}" />
                            </StackPanel>
                        </Button>
                        <CheckBox Grid.Row="0"
                                  Margin="4,0"
                                  HorizontalAlignment="Left"
                                  Content="{k:Localize View_AnalyzeBuild_LoopPlaying}"
                                  IsChecked="{Binding LoopPlaying, ElementName=miniPlayer}" />
                    </StackPanel>
                    <Button Grid.Row="1"
                            Margin="2"
                            HorizontalAlignment="Left"
                            ToolTip="{k:Localize View_AnalyzeBuild_PlayCriticalPath}"
                            Visibility="{Binding CanPlayReferential, Converter={StaticResource NegatedBooleanToVisibilityConverter}}">
                        <Button.Command>
                            <MultiBinding Converter="{core:BoolToCommandConverter}">
                                <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                <Binding Converter="{core:EqualsEnumConverter}"
                                         ConverterParameter="{x:Static vm:PlayingSource.CriticalPath}"
                                         Path="PlayingSource" />
                                <Binding Path="PauseCommand" />
                                <Binding Path="PlayCriticalPath" />
                            </MultiBinding>
                        </Button.Command>
                        <StackPanel Orientation="Horizontal">
                            <Path Width="10"
                                  Height="10"
                                  Data="F1 M 0,0 2,1 0,2 Z"
                                  Fill="{DynamicResource InputForegroundBrush}"
                                  Stretch="Fill">
                                <Path.Visibility>
                                    <MultiBinding Converter="{presentation:NegatedBooleansToVisibilityConverter}">
                                        <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                        <Binding Converter="{core:EqualsEnumConverter}"
                                                 ConverterParameter="{x:Static vm:PlayingSource.CriticalPath}"
                                                 Path="PlayingSource" />
                                    </MultiBinding>
                                </Path.Visibility>
                            </Path>
                            <Path Width="10"
                                  Height="10"
                                  Data="F1 M 0,0L 5,0L 5,25L 0,25L 0,0 Z M 11.5,0L 16.5,0L 16.5,25L 11.5,25L 11.5,0 Z"
                                  Fill="{DynamicResource InputForegroundBrush}"
                                  Stretch="Fill">
                                <Path.Visibility>
                                    <MultiBinding Converter="{presentation:BooleansToVisibilityConverter}">
                                        <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                        <Binding Converter="{core:EqualsEnumConverter}"
                                                 ConverterParameter="{x:Static vm:PlayingSource.CriticalPath}"
                                                 Path="PlayingSource" />
                                    </MultiBinding>
                                </Path.Visibility>
                            </Path>
                            <TextBlock Margin="2,0,0,0" Text="{k:Localize View_AnalyzeBuild_PlayCriticalPath_Short}" />
                        </StackPanel>
                    </Button>
                    <Button Grid.Row="2"
                            Margin="2"
                            HorizontalAlignment="Left"
                            ToolTip="{k:Localize View_AnalyzeBuild_Referential}"
                            Visibility="{Binding CanPlayReferential, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Command>
                            <MultiBinding Converter="{core:BoolToCommandConverter}">
                                <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                <Binding Converter="{core:EqualsEnumConverter}"
                                         ConverterParameter="{x:Static vm:PlayingSource.Referential}"
                                         Path="PlayingSource" />
                                <Binding Path="PauseCommand" />
                                <Binding Path="PlayReferentialCommand" />
                            </MultiBinding>
                        </Button.Command>
                        <StackPanel Orientation="Horizontal">
                            <Path Width="10"
                                  Height="10"
                                  Data="F1 M 0,0 2,1 0,2 Z"
                                  Fill="{DynamicResource InputForegroundBrush}"
                                  Stretch="Fill">
                                <Path.Visibility>
                                    <MultiBinding Converter="{presentation:NegatedBooleansToVisibilityConverter}">
                                        <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                        <Binding Converter="{core:EqualsEnumConverter}"
                                                 ConverterParameter="{x:Static vm:PlayingSource.Referential}"
                                                 Path="PlayingSource" />
                                    </MultiBinding>
                                </Path.Visibility>
                            </Path>
                            <Path Width="10"
                                  Height="10"
                                  Data="F1 M 0,0L 5,0L 5,25L 0,25L 0,0 Z M 11.5,0L 16.5,0L 16.5,25L 11.5,25L 11.5,0 Z"
                                  Fill="{DynamicResource InputForegroundBrush}"
                                  Stretch="Fill">
                                <Path.Visibility>
                                    <MultiBinding Converter="{presentation:BooleansToVisibilityConverter}">
                                        <Binding ElementName="miniPlayer" Path="IsPlaying" />
                                        <Binding Converter="{core:EqualsEnumConverter}"
                                                 ConverterParameter="{x:Static vm:PlayingSource.Referential}"
                                                 Path="PlayingSource" />
                                    </MultiBinding>
                                </Path.Visibility>
                            </Path>
                            <TextBlock Margin="2,0,0,0" Text="{k:Localize View_AnalyzeBuild_Referentials}" />
                        </StackPanel>
                    </Button>
                    <k:KMiniPlayer x:Name="miniPlayer"
                                   Grid.Row="3"
                                   Margin="4"
                                   CurrentItem="{Binding CurrentActionPath, Mode=TwoWay}"
                                   IsMuted="{Binding Source={x:Static local:LocalSettings.Instance}, Path=Mute, Mode=TwoWay}"
                                   ItemsSource="{Binding ActionsPath, Mode=OneWay}"
                                   PlayButtonVisibility="Collapsed"
                                   Position="{Binding CurrentTimelinePosition, Mode=TwoWay}">
                        <i:Interaction.Behaviors>
                            <core:MediaPlayerBehavior />
                        </i:Interaction.Behaviors>
                    </k:KMiniPlayer>
                </Grid>

                <TabControl Grid.Column="1"
                            Margin="4"
                            Visibility="{Binding CurrentActionItem, Converter={StaticResource NotNullToVisibilityConverter}}">

                    <TabItem Header="{k:Localize View_AnalyzeBuild_Action}">
                        <ScrollViewer BorderThickness="0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBox Grid.Column="0"
                                         Margin="0,0,2,2"
                                         IsReadOnly="True"
                                         Text="{Binding CurrentActionItem.Action.WBS}"
                                         TextWrapping="Wrap" />

                                <TextBox x:Name="labelTB"
                                         Grid.Row="0"
                                         Grid.Column="1"
                                         Grid.ColumnSpan="2"
                                         Margin="4,0,2,2"
                                         IsReadOnly="{Binding IsReadOnly}"
                                         MaxLength="{x:Static models:KAction.LabelMaxLength}"
                                         Text="{k:InstantValidatingBinding CurrentActionItem.Action.Label}"
                                         TextWrapping="Wrap" />

                                <CheckBox Grid.Row="1"
                                          Grid.ColumnSpan="2"
                                          Height="24"
                                          Margin="4,0"
                                          Content="!"
                                          Focusable="False"
                                          IsChecked="{Binding CurrentActionItem.Action.IsKeyTaskManaged}"
                                          IsEnabled="{Binding IsReadOnly, Converter={k:NegatedBooleanConverter}}">
                                    <CheckBox.Visibility>
                                        <MultiBinding Converter="{k:NegatedOrBooleansToVisibilityConverter}">
                                            <Binding Path="CurrentActionItem.IsGroup" />
                                            <Binding Path="CurrentActionItem.Action.IsLinkToProcess" />
                                        </MultiBinding>
                                    </CheckBox.Visibility>
                                </CheckBox>

                                <TextBlock Grid.Row="2"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{k:Localize View_AnalyzeBuild_Action_Duration}"
                                           TextWrapping="Wrap" />
                                <TextBox Grid.Row="2"
                                         Grid.Column="1"
                                         Margin="4,0,2,2"
                                         IsReadOnly="{Binding AllowTimingsDurationChange, Converter={StaticResource NegatedBooleanConverter}}"
                                         Text="{core:EnterKeyBinding CurrentActionItem.ManagedDuration,
                                                                     True,
                                                                     Converter={StaticResource TicksToStringConverter}}"
                                         TextWrapping="Wrap">
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="HH:MM:SS" />
                                    </ToolTipService.ToolTip>
                                </TextBox>

                                <CheckBox Grid.Row="2"
                                          Grid.Column="2"
                                          Grid.ColumnSpan="2"
                                          Margin="4"
                                          IsChecked="{Binding CurrentActionItem.Action.IsRandom}"
                                          IsEnabled="{Binding IsNotReadOnly}">
                                    <Path Width="{Binding FontSize, RelativeSource={RelativeSource FindAncestor, AncestorType=CheckBox}}"
                                          Height="{Binding FontSize, RelativeSource={RelativeSource FindAncestor, AncestorType=CheckBox}}"
                                          Margin="0,0,0,0"
                                          Data="M307 384h120v-213h-150l-8 42h-120v-149h-42v363h192z"
                                          Fill="{Binding Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType=CheckBox}}"
                                          RenderTransformOrigin="0.5,0.5"
                                          Stretch="Uniform">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleY="-1" />
                                        </Path.RenderTransform>
                                    </Path>
                                </CheckBox>

                                <TextBlock Grid.Row="3"
                                           MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{k:Localize View_AnalyzeBuild_Action_Resource}"
                                           TextWrapping="Wrap" />
                                <core:DropDownButton Grid.Row="3"
                                                     Grid.Column="1"
                                                     Grid.ColumnSpan="2"
                                                     Margin="4,0,2,2"
                                                     MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                                     Content="{Binding CurrentActionItem.Action.Reduced.Resource.Label}"
                                                     IsEnabled="{Binding IsNotReadOnly}">
                                    <core:DropDownButton.DropDownContent>
                                        <Grid Width="400">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <core:ReferentialPicker x:Name="OperatorsListBox"
                                                                    Margin="4"
                                                                    CanCreate="False"
                                                                    CreateReferentialCommand="{x:Null}"
                                                                    IsEnabled="{Binding IsNotReadOnly}"
                                                                    ItemsSource="{Binding Operators}"
                                                                    ReferentialId="Operator"
                                                                    SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Operator}"
                                                                    SelectionChanged="OperatorsListBox_SelectionChanged"
                                                                    SelectionMode="Single" />

                                            <core:ReferentialPicker x:Name="EquipmentsListBox"
                                                                    Grid.Column="1"
                                                                    Margin="4"
                                                                    CanCreate="False"
                                                                    CreateReferentialCommand="{x:Null}"
                                                                    IsEnabled="{Binding IsNotReadOnly}"
                                                                    ItemsSource="{Binding Equipments}"
                                                                    ReferentialId="Equipment"
                                                                    SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Equipment}"
                                                                    SelectionChanged="EquipmentsListBox_SelectionChanged"
                                                                    SelectionMode="Single" />
                                        </Grid>
                                    </core:DropDownButton.DropDownContent>
                                </core:DropDownButton>

                                <TextBlock Grid.Row="4"
                                           MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Category}"
                                           TextWrapping="Wrap" />
                                <core:DropDownButton Grid.Row="4"
                                                     Grid.Column="1"
                                                     Grid.ColumnSpan="2"
                                                     Margin="4,0,2,2"
                                                     MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                                     Content="{Binding CurrentActionItem.Action.Category.Label}"
                                                     IsEnabled="{Binding IsNotReadOnly}">
                                    <core:DropDownButton.DropDownContent>
                                        <Grid Width="200">
                                            <core:ReferentialPicker x:Name="CategoriesListBox"
                                                                    Margin="4"
                                                                    CanCreate="False"
                                                                    CreateReferentialCommand="{x:Null}"
                                                                    IsEnabled="{Binding IsNotReadOnly}"
                                                                    ItemsSource="{Binding Categories}"
                                                                    ReferentialId="Category"
                                                                    SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Category}"
                                                                    SelectionChanged="CategoriesListBox_SelectionChanged"
                                                                    SelectionMode="Single" />
                                        </Grid>
                                    </core:DropDownButton.DropDownContent>
                                </core:DropDownButton>

                                <TextBlock Grid.Row="5"
                                           MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Skill}"
                                           TextWrapping="Wrap" />
                                <core:DropDownButton Grid.Row="5"
                                                     Grid.Column="1"
                                                     Grid.ColumnSpan="2"
                                                     Height="24"
                                                     Margin="4,0,2,2"
                                                     MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                                     Content="{Binding CurrentActionItem.Action.Skill.Label}"
                                                     IsEnabled="{Binding IsNotReadOnly}">
                                    <core:DropDownButton.DropDownContent>
                                        <Grid Width="200">
                                            <core:ReferentialPicker x:Name="SkillsListBox"
                                                                    Margin="4"
                                                                    CanCreate="False"
                                                                    CreateReferentialCommand="{x:Null}"
                                                                    IsEnabled="{Binding IsNotReadOnly}"
                                                                    ItemsSource="{Binding Skills}"
                                                                    ReferentialId="Skill"
                                                                    SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Skill}"
                                                                    SelectionChanged="SkillsListBox_SelectionChanged"
                                                                    SelectionMode="Single" />
                                        </Grid>
                                    </core:DropDownButton.DropDownContent>
                                </core:DropDownButton>

                                <Grid Grid.Row="6"
                                      Grid.ColumnSpan="3"
                                      Margin="0,0,0,2"
                                      VerticalAlignment="Top"
                                      MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}"
                                      Grid.IsSharedSizeScope="True">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <views:CustomLabelUC Grid.Row="0"
                                                         Label="{Binding CustomFieldsLabels.Text1}"
                                                         MaxLength="{x:Static models:KAction.CustomTextValueUIGlobalMaxLength}"
                                                         Value="{Binding CurrentActionItem.Action.CustomTextValue}" />
                                    <views:CustomLabelUC Grid.Row="1"
                                                         Label="{Binding CustomFieldsLabels.Text2}"
                                                         MaxLength="{x:Static models:KAction.CustomTextValueUIGlobalMaxLength}"
                                                         Value="{Binding CurrentActionItem.Action.CustomTextValue2}" />
                                    <views:CustomLabelUC Grid.Row="2"
                                                         Label="{Binding CustomFieldsLabels.Text3}"
                                                         MaxLength="{x:Static models:KAction.CustomTextValueUIGlobalMaxLength}"
                                                         Value="{Binding CurrentActionItem.Action.CustomTextValue3}" />
                                    <views:CustomLabelUC Grid.Row="3"
                                                         Label="{Binding CustomFieldsLabels.Text4}"
                                                         MaxLength="{x:Static models:KAction.CustomTextValueUIGlobalMaxLength}"
                                                         Value="{Binding CurrentActionItem.Action.CustomTextValue4}" />

                                    <views:CustomLabelUC Grid.Row="4"
                                                         AcceptsReturn="False"
                                                         ExpandedValueColumn="true"
                                                         Label="{Binding CustomFieldsLabels.Numeric1}"
                                                         Value="{Binding CurrentActionItem.Action.CustomNumericValueText, Converter={core:DecimalConverter}}">
                                        <i:Interaction.Behaviors>
                                            <core:AllowCharacter Character="-" />
                                        </i:Interaction.Behaviors>
                                    </views:CustomLabelUC>
                                    <views:CustomLabelUC Grid.Row="5"
                                                         AcceptsReturn="False"
                                                         ExpandedValueColumn="true"
                                                         Label="{Binding CustomFieldsLabels.Numeric2}"
                                                         Value="{Binding CurrentActionItem.Action.CustomNumericValue2Text, Converter={core:DecimalConverter}}">
                                        <i:Interaction.Behaviors>
                                            <core:AllowCharacter Character="-" />
                                        </i:Interaction.Behaviors>
                                    </views:CustomLabelUC>
                                    <views:CustomLabelUC Grid.Row="6"
                                                         AcceptsReturn="False"
                                                         ExpandedValueColumn="true"
                                                         Label="{Binding CustomFieldsLabels.Numeric3}"
                                                         Value="{Binding CurrentActionItem.Action.CustomNumericValue3Text, Converter={core:DecimalConverter}}">
                                        <i:Interaction.Behaviors>
                                            <core:AllowCharacter Character="-" />
                                        </i:Interaction.Behaviors>
                                    </views:CustomLabelUC>
                                    <views:CustomLabelUC Grid.Row="7"
                                                         AcceptsReturn="False"
                                                         ExpandedValueColumn="true"
                                                         Label="{Binding CustomFieldsLabels.Numeric4}"
                                                         Value="{Binding CurrentActionItem.Action.CustomNumericValue4Text, Converter={core:DecimalConverter}}">
                                        <i:Interaction.Behaviors>
                                            <core:AllowCharacter Character="-" />
                                        </i:Interaction.Behaviors>
                                    </views:CustomLabelUC>

                                </Grid>

                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <TabItem MahApps:VisibilityHelper.IsCollapsed="{Binding CurrentActionItem.Action.IsLinkToProcess}" Header="{k:Localize View_AnalyzeBuild_Action_Details}">
                        <ScrollViewer BorderThickness="0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref1}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref1Visibility}" />
                                <TextBlock Grid.Row="0"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref1Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref1Visibility}" />

                                <TextBlock Grid.Row="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref2}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref2Visibility}" />
                                <TextBlock Grid.Row="1"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref2Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref2Visibility}" />

                                <TextBlock Grid.Row="2"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref3}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref3Visibility}" />
                                <TextBlock Grid.Row="2"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref3Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref3Visibility}" />

                                <TextBlock Grid.Row="3"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref4}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref4Visibility}" />
                                <TextBlock Grid.Row="3"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref4Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref4Visibility}" />

                                <TextBlock Grid.Row="4"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref5}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref5Visibility}" />
                                <TextBlock Grid.Row="4"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref5Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref5Visibility}" />

                                <TextBlock Grid.Row="5"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref6}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref6Visibility}" />
                                <TextBlock Grid.Row="5"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref6Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref6Visibility}" />

                                <TextBlock Grid.Row="6"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{x:Static core:ReferentialsUse.Ref7}"
                                           TextWrapping="Wrap"
                                           Visibility="{x:Static core:ReferentialsUse.Ref7Visibility}" />
                                <TextBlock Grid.Row="6"
                                           Grid.Column="1"
                                           Style="{StaticResource LabelStyle}"
                                           Text="{Binding CurrentActionItem.Ref7Labels}"
                                           Visibility="{x:Static core:ReferentialsUse.Ref7Visibility}" />
                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <TabItem Header="{Binding ReductionLabel}" Visibility="{Binding ReduceCurrentActionItemVisibility}">
                        <ScrollViewer BorderThickness="0">
                            <Grid>
                                <Button d:IsHidden="True"
                                        Command="{Binding ConvertToReducedCommand}"
                                        Content="{k:Localize View_AnalyzeBuild_Improve}"
                                        Visibility="{Binding CurrentActionItem.Action.IsReduced, Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />
                                <Grid DataContext="{Binding CurrentActionItem.Action}" Visibility="{Binding IsReduced, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <ListBox Grid.ColumnSpan="2"
                                             Margin="4,0,2,2"
                                             HorizontalAlignment="Left"
                                             IsEnabled="{k:UCBinding DataContext.IsNotReadOnly}"
                                             ItemsSource="{k:UCBinding DataContext.ActionTypes}"
                                             SelectedItem="{k:InstantValidatingBinding Reduced.ActionType}"
                                             Style="{StaticResource radioListBoxStyle}">
                                        <ListBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Orientation="Horizontal" />
                                            </ItemsPanelTemplate>
                                        </ListBox.ItemsPanel>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding ContextualLabel}" TextWrapping="WrapWithOverflow" />
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>

                                    <TextBlock Grid.Row="1"
                                               Style="{StaticResource LabelStyle}"
                                               Text="{k:Localize View_AnalyzeBuild_Action_Resource}"
                                               TextWrapping="Wrap"
                                               Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                        Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />
                                    <core:DropDownButton Grid.Row="1"
                                                         Grid.Column="1"
                                                         Grid.ColumnSpan="2"
                                                         Margin="4,0,2,2"
                                                         Content="{Binding CurrentActionItem.Action.Reduced.Resource.Label}"
                                                         DataContext="{k:UCBinding DataContext}"
                                                         IsEnabled="{Binding IsNotReadOnly}"
                                                         Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                                  Converter={StaticResource NegatedBooleanToVisibilityConverter}}">
                                        <core:DropDownButton.DropDownContent>
                                            <Grid Width="400">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <core:ReferentialPicker x:Name="ReductionOperatorsListBox"
                                                                        Margin="4"
                                                                        CanCreate="False"
                                                                        CreateReferentialCommand="{x:Null}"
                                                                        IsEnabled="{Binding IsNotReadOnly}"
                                                                        ItemsSource="{Binding Operators}"
                                                                        ReferentialId="Operator"
                                                                        SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Operator}"
                                                                        SelectionChanged="ReductionOperatorsListBox_SelectionChanged"
                                                                        SelectionMode="Single" />

                                                <core:ReferentialPicker x:Name="ReductionEquipmentsListBox"
                                                                        Grid.Column="1"
                                                                        Margin="4"
                                                                        CanCreate="False"
                                                                        CreateReferentialCommand="{x:Null}"
                                                                        IsEnabled="{Binding IsNotReadOnly}"
                                                                        ItemsSource="{Binding Equipments}"
                                                                        ReferentialId="Equipment"
                                                                        SelectedItem="{k:InstantValidatingBinding CurrentActionItem.Action.Equipment}"
                                                                        SelectionChanged="ReductionEquipmentsListBox_SelectionChanged"
                                                                        SelectionMode="Single" />
                                            </Grid>
                                        </core:DropDownButton.DropDownContent>
                                    </core:DropDownButton>

                                    <TextBlock Grid.Row="2"
                                               Style="{StaticResource LabelStyle}"
                                               Text="{k:Localize View_AnalyzeBuild_ActionImproved_PercentageReduction}"
                                               TextWrapping="Wrap"
                                               Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                        Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />
                                    <TextBox Grid.Row="2"
                                             Grid.Column="1"
                                             Margin="4,0,2,2"
                                             IsEnabled="{Binding Reduced.ActionType, Converter={converters:ActionTypeToDisabledConverter}}"
                                             IsReadOnly="{k:UCBinding DataContext.IsReadOnly}"
                                             Text="{core:EnterKeyBinding Reduced.ReductionRatio,
                                                                         True,
                                                                         Converter={StaticResource RatioToPercentConverter},
                                                                         ValidatesOnExceptions=True,
                                                                         Validates=True,
                                                                         ValidatesOnDataErrors=True}"
                                             TextWrapping="Wrap"
                                             Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                      Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />

                                    <TextBlock Grid.Row="3"
                                               Style="{StaticResource LabelStyle}"
                                               Text="{k:Localize View_AnalyzeBuild_ActionImproved_Solution}"
                                               TextWrapping="Wrap"
                                               Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                        Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />
                                    <CheckBox Grid.Row="3"
                                              Grid.Column="1"
                                              Content="{k:Localize View_AnalyzeBuild_ActionImproved_Approved}"
                                              IsChecked="{k:ValidatingBinding Reduced.Approved}"
                                              IsEnabled="{k:UCBinding DataContext.IsNotReadOnly}"
                                              Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                       Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />
                                    <ComboBox Grid.Row="4"
                                              Grid.ColumnSpan="2"
                                              Margin="4,0,2,2"
                                              helpers:EditableComboBox.MaxLength="{Binding Reduced.GetSolutionMaxLength}"
                                              IsEditable="True"
                                              IsEnabled="{Binding DataContext.IsReadOnly, Converter={k:NegatedBooleanConverter}, RelativeSource={RelativeSource FindAncestor, AncestorType=views:BuildView}}"
                                              IsReadOnly="{k:UCBinding DataContext.IsReadOnly,
                                                                       RelativeSource={RelativeSource FindAncestor,
                                                                                                      AncestorType=views:BuildView}}"
                                              ItemsSource="{k:UCBinding DataContext.Solutions}"
                                              Text="{k:ValidatingBinding Reduced.Solution}"
                                              Visibility="{k:UCBinding DataContext.ShowPastInternalisationOrExternalisation,
                                                                       Converter={StaticResource NegatedBooleanToVisibilityConverter}}" />

                                </Grid>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

            </Grid>


            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width=".4*" />
                    <ColumnDefinition Width=".6*" />
                </Grid.ColumnDefinitions>

                <charting:Chart x:Name="resourceLoadChart"
                                Grid.Column="0"
                                Margin="4"
                                Background="Transparent"
                                BorderThickness="0">
                    <charting:Chart.LegendStyle>
                        <Style TargetType="{x:Type datavis:Legend}">
                            <Setter Property="Visibility" Value="Collapsed" />
                        </Style>
                    </charting:Chart.LegendStyle>
                    <charting:Chart.Style>
                        <Style TargetType="{x:Type charting:Chart}">
                            <Setter Property="Template">

                                <Setter.Value>

                                    <ControlTemplate TargetType="{x:Type charting:Chart}">
                                        <Border Padding="{TemplateBinding Padding}"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>

                                                <!--<datavis:Title Content="{TemplateBinding Title}" Style="{TemplateBinding TitleStyle}" />-->

                                                <!--  Use a nested Grid to avoid possible clipping behavior resulting from ColumnSpan+Width=Auto  -->
                                                <Grid Grid.Row="1" Margin="0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <!--<datavis:Legend x:Name="Legend" Header="{TemplateBinding LegendTitle}" Style="{TemplateBinding LegendStyle}" Grid.Column="1" />-->
                                                    <chartingprimitives:EdgePanel x:Name="ChartArea" Style="{TemplateBinding ChartAreaStyle}">
                                                        <Grid Panel.ZIndex="-1" Style="{TemplateBinding PlotAreaStyle}" />
                                                        <Border Panel.ZIndex="10"
                                                                BorderBrush="#FF919191"
                                                                BorderThickness="1" />
                                                    </chartingprimitives:EdgePanel>
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </charting:Chart.Style>

                    <charting:Chart.Axes>
                        <charting:CategoryAxis Orientation="X" />
                        <core:KLinearAxis Title="%"
                                          Interval="20"
                                          Minimum="0"
                                          MinimumMaximum="100"
                                          Orientation="Y"
                                          ShowGridLines="True" />
                    </charting:Chart.Axes>

                    <core:ColumnSeriesOverlapped x:Name="series1"
                                                 DataPointStyle="{StaticResource DescriptionToolTipColumnDataPointStyle}"
                                                 DependentValuePath="Load"
                                                 IndependentValuePath="Resource.Label"
                                                 ItemsSource="{Binding ResourcesLoad}" />

                    <core:ColumnSeriesOverlapped x:Name="series2"
                                                 DependentValuePath="Overload"
                                                 IndependentValuePath="Resource.Label"
                                                 ItemsSource="{Binding ResourcesLoad}"
                                                 WidthRatio=".4">
                        <core:ColumnSeriesOverlapped.DataPointStyle>

                            <Style BasedOn="{StaticResource DescriptionToolTipColumnDataPointStyle}" TargetType="{x:Type charting:ColumnDataPoint}">
                                <Setter Property="Background" Value="Red" />
                                <!--<Setter Property="BorderBrush" Value="Black" />-->
                                <Setter Property="BorderThickness" Value="0" />
                            </Style>

                        </core:ColumnSeriesOverlapped.DataPointStyle>
                    </core:ColumnSeriesOverlapped>


                </charting:Chart>
                <ListBox MinHeight="26"
                         Margin="4"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Top"
                         Background="{DynamicResource DarkControlBackgroundBrush}"
                         ItemsSource="{Binding LoadChartFilters}"
                         ScrollViewer.CanContentScroll="False"
                         SelectedItem="{Binding SelectedLoadChartFilter}">
                    <ListBox.Style>
                        <Style BasedOn="{StaticResource radioListBoxStyle}" TargetType="{x:Type ListBox}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=resourceLoadChart, Path=IsMouseOver}" Value="true">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}" Value="true">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListBox.Style>
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Width="{k:AncestorBinding ActualWidth, {x:Type ListBox}}" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemContainerStyle>
                        <Style BasedOn="{StaticResource radioListBoxItemStyle}" TargetType="{x:Type ListBoxItem}">
                            <Setter Property="Padding" Value="4,2" />
                            <Setter Property="FontSize" Value="{StaticResource DefaultFontSize}" />
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>

                <Grid Grid.Column="1"
                      Margin="4,4,4,26"
                      DataContext="{Binding CurrentScenario}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="1"
                               Style="{StaticResource LabelStyle}"
                               Text="{k:Localize View_AnalyzeBuild_Scenario_Label}"
                               TextWrapping="Wrap" />
                    <TextBox Grid.Row="1"
                             Grid.Column="1"
                             Margin="4,0,2,2"
                             IsReadOnly="True"
                             Text="{k:InstantValidatingBinding Label}"
                             TextWrapping="Wrap" />

                    <TextBlock Grid.Row="2"
                               Style="{StaticResource LabelStyle}"
                               Text="{k:Localize View_AnalyzeBuild_Scenario_State}"
                               TextWrapping="Wrap" />
                    <TextBox Grid.Row="2"
                             Grid.Column="1"
                             Margin="4,0,2,2"
                             IsReadOnly="True"
                             Text="{Binding State.ShortLabel}"
                             TextWrapping="Wrap" />

                    <TextBlock Grid.Row="3"
                               Style="{StaticResource LabelStyle}"
                               Text="{k:Localize View_AnalyzeBuild_Scenario_Description}"
                               TextWrapping="Wrap" />
                    <TextBox Grid.Row="3"
                             Grid.Column="1"
                             Margin="4,0,2,2"
                             AcceptsReturn="True"
                             IsReadOnly="True"
                             Text="{k:InstantValidatingBinding Description}"
                             TextWrapping="Wrap" />

                    <TextBlock Grid.Row="4"
                               Style="{StaticResource LabelStyle}"
                               Text="{k:Localize View_AnalyzeBuild_Scenario_OriginalScenario}"
                               TextWrapping="Wrap" />
                    <TextBox Grid.Row="4"
                             Grid.Column="1"
                             Margin="4,0,2,2"
                             IsReadOnly="True"
                             Text="{Binding Original.Label}"
                             TextWrapping="Wrap" />

                </Grid>

            </Grid>

        </Grid>

        <StackPanel Grid.Row="2"
                    Grid.Column="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Orientation="Horizontal"
                    Visibility="{Binding CanChange, Converter={StaticResource NegatedBooleanToVisibilityConverter}}">
            <Button MinWidth="{StaticResource ValidationButtonMinWidth}"
                    Margin="4"
                    Command="{k:CommandBinding ValidateCommand}"
                    Content="{k:Localize Common_OK}"
                    ToolTip="{k:Localize Common_OK,
                                         Shortcut=Save}">
                <i:Interaction.Behaviors>
                    <core:DataStateBehavior Binding="{Binding CanChange}"
                                            FalseState="ColorGreen"
                                            TrueState="ColorDefault"
                                            Value="true" />
                </i:Interaction.Behaviors>
            </Button>
            <Button MinWidth="{StaticResource ValidationButtonMinWidth}"
                    Margin="4"
                    Command="{k:CommandBinding CancelCommand}"
                    Content="{k:Localize Common_Cancel}"
                    ToolTip="{k:Localize Common_Cancel,
                                         Shortcut=Cancel}">
                <i:Interaction.Behaviors>
                    <core:DataStateBehavior Binding="{Binding CanChange}"
                                            FalseState="ColorGreen"
                                            TrueState="ColorDefault"
                                            Value="true" />
                </i:Interaction.Behaviors>
            </Button>
        </StackPanel>

    </Grid>
</UserControl>


